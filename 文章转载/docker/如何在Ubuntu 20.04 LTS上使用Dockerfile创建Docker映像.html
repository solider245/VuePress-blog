<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>如何在Ubuntu 20.04 LTS上使用Dockerfile创建Docker映像 | 吴起的个人网站</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="https://images-1255533533.cos.ap-shanghai.myqcloud.com/20190817214528_05c52e04cf64654248918bfc2a1f64ab.png">
    <link rel="manifest" href="/VuePress-blog/manifest.json">
    <link rel="apple-touch-icon" href="/VuePress-blog/icons/apple-touch-icon-152x152.png">
    <link rel="mask-icon" href="/VuePress-blog/icons/safari-pinned-tab.svg" color="#3eaf7c">
    <meta name="description" content="2020年6月19日的最新的文章">
    <meta name="author" content="中箭的吴起">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    <link rel="preload" href="/VuePress-blog/assets/css/0.styles.f7cbc213.css" as="style"><link rel="preload" href="/VuePress-blog/assets/js/app.776d277d.js" as="script"><link rel="preload" href="/VuePress-blog/assets/js/2.c5117f2a.js" as="script"><link rel="preload" href="/VuePress-blog/assets/js/199.bbbe2ec0.js" as="script"><link rel="prefetch" href="/VuePress-blog/assets/js/10.63714471.js"><link rel="prefetch" href="/VuePress-blog/assets/js/100.1cec5f39.js"><link rel="prefetch" href="/VuePress-blog/assets/js/101.c74c6d95.js"><link rel="prefetch" href="/VuePress-blog/assets/js/102.d22dd18b.js"><link rel="prefetch" href="/VuePress-blog/assets/js/103.409414e4.js"><link rel="prefetch" href="/VuePress-blog/assets/js/104.d4463a76.js"><link rel="prefetch" href="/VuePress-blog/assets/js/105.f70dcd32.js"><link rel="prefetch" href="/VuePress-blog/assets/js/106.6516b84b.js"><link rel="prefetch" href="/VuePress-blog/assets/js/107.bdeabcbf.js"><link rel="prefetch" href="/VuePress-blog/assets/js/108.8c48acb2.js"><link rel="prefetch" href="/VuePress-blog/assets/js/109.85df5626.js"><link rel="prefetch" href="/VuePress-blog/assets/js/11.a24f4a33.js"><link rel="prefetch" href="/VuePress-blog/assets/js/110.5e67e89d.js"><link rel="prefetch" href="/VuePress-blog/assets/js/111.769d339f.js"><link rel="prefetch" href="/VuePress-blog/assets/js/112.e75614b5.js"><link rel="prefetch" href="/VuePress-blog/assets/js/113.63d1e519.js"><link rel="prefetch" href="/VuePress-blog/assets/js/114.e7a470dc.js"><link rel="prefetch" href="/VuePress-blog/assets/js/115.66e52ce5.js"><link rel="prefetch" href="/VuePress-blog/assets/js/116.4f75586b.js"><link rel="prefetch" href="/VuePress-blog/assets/js/117.c2ad36ee.js"><link rel="prefetch" href="/VuePress-blog/assets/js/118.b6e98de6.js"><link rel="prefetch" href="/VuePress-blog/assets/js/119.b57896d6.js"><link rel="prefetch" href="/VuePress-blog/assets/js/12.abc1e9a9.js"><link rel="prefetch" href="/VuePress-blog/assets/js/120.e5da282b.js"><link rel="prefetch" href="/VuePress-blog/assets/js/121.eb8b36b3.js"><link rel="prefetch" href="/VuePress-blog/assets/js/122.e3fa1136.js"><link rel="prefetch" href="/VuePress-blog/assets/js/123.d4a35a0f.js"><link rel="prefetch" href="/VuePress-blog/assets/js/124.894663d4.js"><link rel="prefetch" href="/VuePress-blog/assets/js/125.0e2df5ef.js"><link rel="prefetch" href="/VuePress-blog/assets/js/126.a62c9f29.js"><link rel="prefetch" href="/VuePress-blog/assets/js/127.c4c12b2c.js"><link rel="prefetch" href="/VuePress-blog/assets/js/128.a3d4f63f.js"><link rel="prefetch" href="/VuePress-blog/assets/js/129.a4a9c4b9.js"><link rel="prefetch" href="/VuePress-blog/assets/js/13.f38ab9c5.js"><link rel="prefetch" href="/VuePress-blog/assets/js/130.2b6974e6.js"><link rel="prefetch" href="/VuePress-blog/assets/js/131.2c254cb6.js"><link rel="prefetch" href="/VuePress-blog/assets/js/132.3c69d560.js"><link rel="prefetch" href="/VuePress-blog/assets/js/133.52d6127d.js"><link rel="prefetch" href="/VuePress-blog/assets/js/134.c2d0a90c.js"><link rel="prefetch" href="/VuePress-blog/assets/js/135.cd6b9f1a.js"><link rel="prefetch" href="/VuePress-blog/assets/js/136.1dc89614.js"><link rel="prefetch" href="/VuePress-blog/assets/js/137.f9b5cb48.js"><link rel="prefetch" href="/VuePress-blog/assets/js/138.41523b28.js"><link rel="prefetch" href="/VuePress-blog/assets/js/139.2e2adbf4.js"><link rel="prefetch" href="/VuePress-blog/assets/js/14.fb0fad09.js"><link rel="prefetch" href="/VuePress-blog/assets/js/140.112e35af.js"><link rel="prefetch" href="/VuePress-blog/assets/js/141.2e348226.js"><link rel="prefetch" href="/VuePress-blog/assets/js/142.59b5c9ef.js"><link rel="prefetch" href="/VuePress-blog/assets/js/143.a6a726d2.js"><link rel="prefetch" href="/VuePress-blog/assets/js/144.ec4a46cb.js"><link rel="prefetch" href="/VuePress-blog/assets/js/145.0b187c1e.js"><link rel="prefetch" href="/VuePress-blog/assets/js/146.b3977b6a.js"><link rel="prefetch" href="/VuePress-blog/assets/js/147.070dded6.js"><link rel="prefetch" href="/VuePress-blog/assets/js/148.703bfa68.js"><link rel="prefetch" href="/VuePress-blog/assets/js/149.eef402f6.js"><link rel="prefetch" href="/VuePress-blog/assets/js/15.a3e85e42.js"><link rel="prefetch" href="/VuePress-blog/assets/js/150.f625ba2f.js"><link rel="prefetch" href="/VuePress-blog/assets/js/151.22a07089.js"><link rel="prefetch" href="/VuePress-blog/assets/js/152.d84ba7a0.js"><link rel="prefetch" href="/VuePress-blog/assets/js/153.fb36a102.js"><link rel="prefetch" href="/VuePress-blog/assets/js/154.6b471035.js"><link rel="prefetch" href="/VuePress-blog/assets/js/155.511972d8.js"><link rel="prefetch" href="/VuePress-blog/assets/js/156.9b71a1ed.js"><link rel="prefetch" href="/VuePress-blog/assets/js/157.b1ced696.js"><link rel="prefetch" href="/VuePress-blog/assets/js/158.df097da9.js"><link rel="prefetch" href="/VuePress-blog/assets/js/159.e0884310.js"><link rel="prefetch" href="/VuePress-blog/assets/js/16.1487bb0e.js"><link rel="prefetch" href="/VuePress-blog/assets/js/160.19c256dc.js"><link rel="prefetch" href="/VuePress-blog/assets/js/161.b4a55559.js"><link rel="prefetch" href="/VuePress-blog/assets/js/162.3bf8822d.js"><link rel="prefetch" href="/VuePress-blog/assets/js/163.b02d1d5b.js"><link rel="prefetch" href="/VuePress-blog/assets/js/164.6efbaf12.js"><link rel="prefetch" href="/VuePress-blog/assets/js/165.ec61fd46.js"><link rel="prefetch" href="/VuePress-blog/assets/js/166.1aeb18e9.js"><link rel="prefetch" href="/VuePress-blog/assets/js/167.53136d07.js"><link rel="prefetch" href="/VuePress-blog/assets/js/168.860b0f88.js"><link rel="prefetch" href="/VuePress-blog/assets/js/169.1701350b.js"><link rel="prefetch" href="/VuePress-blog/assets/js/17.c965c030.js"><link rel="prefetch" href="/VuePress-blog/assets/js/170.d3659f87.js"><link rel="prefetch" href="/VuePress-blog/assets/js/171.6299f6e6.js"><link rel="prefetch" href="/VuePress-blog/assets/js/172.14097eb7.js"><link rel="prefetch" href="/VuePress-blog/assets/js/173.cd9135dd.js"><link rel="prefetch" href="/VuePress-blog/assets/js/174.4f623e28.js"><link rel="prefetch" href="/VuePress-blog/assets/js/175.1528ea30.js"><link rel="prefetch" href="/VuePress-blog/assets/js/176.4b91e0a6.js"><link rel="prefetch" href="/VuePress-blog/assets/js/177.9d0306c6.js"><link rel="prefetch" href="/VuePress-blog/assets/js/178.135bf962.js"><link rel="prefetch" href="/VuePress-blog/assets/js/179.09bf5238.js"><link rel="prefetch" href="/VuePress-blog/assets/js/18.7dab8018.js"><link rel="prefetch" href="/VuePress-blog/assets/js/180.6d15ee73.js"><link rel="prefetch" href="/VuePress-blog/assets/js/181.16ccddbf.js"><link rel="prefetch" href="/VuePress-blog/assets/js/182.a440c46e.js"><link rel="prefetch" href="/VuePress-blog/assets/js/183.3b17ab33.js"><link rel="prefetch" href="/VuePress-blog/assets/js/184.1c37fda0.js"><link rel="prefetch" href="/VuePress-blog/assets/js/185.5e91aae0.js"><link rel="prefetch" href="/VuePress-blog/assets/js/186.c040be0b.js"><link rel="prefetch" href="/VuePress-blog/assets/js/187.04c35a68.js"><link rel="prefetch" href="/VuePress-blog/assets/js/188.d3dffa3f.js"><link rel="prefetch" href="/VuePress-blog/assets/js/189.f8d1a701.js"><link rel="prefetch" href="/VuePress-blog/assets/js/19.936a56a4.js"><link rel="prefetch" href="/VuePress-blog/assets/js/190.935f2ffb.js"><link rel="prefetch" href="/VuePress-blog/assets/js/191.ce68c987.js"><link rel="prefetch" href="/VuePress-blog/assets/js/192.2cd5f900.js"><link rel="prefetch" href="/VuePress-blog/assets/js/193.4fffa096.js"><link rel="prefetch" href="/VuePress-blog/assets/js/194.763b33a4.js"><link rel="prefetch" href="/VuePress-blog/assets/js/195.41c8a153.js"><link rel="prefetch" href="/VuePress-blog/assets/js/196.18b4eb2c.js"><link rel="prefetch" href="/VuePress-blog/assets/js/197.7670df82.js"><link rel="prefetch" href="/VuePress-blog/assets/js/198.680a1a80.js"><link rel="prefetch" href="/VuePress-blog/assets/js/20.1da56eb7.js"><link rel="prefetch" href="/VuePress-blog/assets/js/200.de87ea80.js"><link rel="prefetch" href="/VuePress-blog/assets/js/201.0ceace3d.js"><link rel="prefetch" href="/VuePress-blog/assets/js/202.c2800a06.js"><link rel="prefetch" href="/VuePress-blog/assets/js/203.48924c48.js"><link rel="prefetch" href="/VuePress-blog/assets/js/204.9fb412e6.js"><link rel="prefetch" href="/VuePress-blog/assets/js/205.19599c35.js"><link rel="prefetch" href="/VuePress-blog/assets/js/206.1a278f71.js"><link rel="prefetch" href="/VuePress-blog/assets/js/207.378bf6a0.js"><link rel="prefetch" href="/VuePress-blog/assets/js/208.dec187fe.js"><link rel="prefetch" href="/VuePress-blog/assets/js/209.d3326143.js"><link rel="prefetch" href="/VuePress-blog/assets/js/21.14a0c6c5.js"><link rel="prefetch" href="/VuePress-blog/assets/js/210.ed9af624.js"><link rel="prefetch" href="/VuePress-blog/assets/js/211.4c2999ee.js"><link rel="prefetch" href="/VuePress-blog/assets/js/212.b7055185.js"><link rel="prefetch" href="/VuePress-blog/assets/js/213.95bd0c97.js"><link rel="prefetch" href="/VuePress-blog/assets/js/214.be14627f.js"><link rel="prefetch" href="/VuePress-blog/assets/js/215.8532e5a4.js"><link rel="prefetch" href="/VuePress-blog/assets/js/216.956add10.js"><link rel="prefetch" href="/VuePress-blog/assets/js/217.b921800c.js"><link rel="prefetch" href="/VuePress-blog/assets/js/218.279a2533.js"><link rel="prefetch" href="/VuePress-blog/assets/js/219.941f503f.js"><link rel="prefetch" href="/VuePress-blog/assets/js/22.207eb093.js"><link rel="prefetch" href="/VuePress-blog/assets/js/23.fcaf57a6.js"><link rel="prefetch" href="/VuePress-blog/assets/js/24.549b45ee.js"><link rel="prefetch" href="/VuePress-blog/assets/js/25.68d51b90.js"><link rel="prefetch" href="/VuePress-blog/assets/js/26.75eef058.js"><link rel="prefetch" href="/VuePress-blog/assets/js/27.e465c84f.js"><link rel="prefetch" href="/VuePress-blog/assets/js/28.ec75d8c3.js"><link rel="prefetch" href="/VuePress-blog/assets/js/29.e22ecade.js"><link rel="prefetch" href="/VuePress-blog/assets/js/3.85032dd8.js"><link rel="prefetch" href="/VuePress-blog/assets/js/30.eac685a4.js"><link rel="prefetch" href="/VuePress-blog/assets/js/31.2d55d3f1.js"><link rel="prefetch" href="/VuePress-blog/assets/js/32.9a6373e2.js"><link rel="prefetch" href="/VuePress-blog/assets/js/33.91a32ba3.js"><link rel="prefetch" href="/VuePress-blog/assets/js/34.9b401b73.js"><link rel="prefetch" href="/VuePress-blog/assets/js/35.a1a2bcde.js"><link rel="prefetch" href="/VuePress-blog/assets/js/36.405a7a4c.js"><link rel="prefetch" href="/VuePress-blog/assets/js/37.d6422337.js"><link rel="prefetch" href="/VuePress-blog/assets/js/38.9915a3eb.js"><link rel="prefetch" href="/VuePress-blog/assets/js/39.82fe0431.js"><link rel="prefetch" href="/VuePress-blog/assets/js/4.7334dde5.js"><link rel="prefetch" href="/VuePress-blog/assets/js/40.76830c33.js"><link rel="prefetch" href="/VuePress-blog/assets/js/41.d1dfc6c3.js"><link rel="prefetch" href="/VuePress-blog/assets/js/42.12371fe2.js"><link rel="prefetch" href="/VuePress-blog/assets/js/43.e3607529.js"><link rel="prefetch" href="/VuePress-blog/assets/js/44.6cec67f8.js"><link rel="prefetch" href="/VuePress-blog/assets/js/45.c20ac641.js"><link rel="prefetch" href="/VuePress-blog/assets/js/46.50d5ceed.js"><link rel="prefetch" href="/VuePress-blog/assets/js/47.6f06c416.js"><link rel="prefetch" href="/VuePress-blog/assets/js/48.08a068dc.js"><link rel="prefetch" href="/VuePress-blog/assets/js/49.e6b4bd72.js"><link rel="prefetch" href="/VuePress-blog/assets/js/5.7139b9b4.js"><link rel="prefetch" href="/VuePress-blog/assets/js/50.3cb53aad.js"><link rel="prefetch" href="/VuePress-blog/assets/js/51.0e647151.js"><link rel="prefetch" href="/VuePress-blog/assets/js/52.7ff01978.js"><link rel="prefetch" href="/VuePress-blog/assets/js/53.36a9d767.js"><link rel="prefetch" href="/VuePress-blog/assets/js/54.e6bbecb4.js"><link rel="prefetch" href="/VuePress-blog/assets/js/55.bdf81af3.js"><link rel="prefetch" href="/VuePress-blog/assets/js/56.5c96c795.js"><link rel="prefetch" href="/VuePress-blog/assets/js/57.f89a2345.js"><link rel="prefetch" href="/VuePress-blog/assets/js/58.d11b047a.js"><link rel="prefetch" href="/VuePress-blog/assets/js/59.12c9a488.js"><link rel="prefetch" href="/VuePress-blog/assets/js/6.6e6603ff.js"><link rel="prefetch" href="/VuePress-blog/assets/js/60.ba63105e.js"><link rel="prefetch" href="/VuePress-blog/assets/js/61.a6c1a4f7.js"><link rel="prefetch" href="/VuePress-blog/assets/js/62.3cc2256f.js"><link rel="prefetch" href="/VuePress-blog/assets/js/63.c33f9fe1.js"><link rel="prefetch" href="/VuePress-blog/assets/js/64.9200eb22.js"><link rel="prefetch" href="/VuePress-blog/assets/js/65.fd000469.js"><link rel="prefetch" href="/VuePress-blog/assets/js/66.512243e8.js"><link rel="prefetch" href="/VuePress-blog/assets/js/67.faaf727b.js"><link rel="prefetch" href="/VuePress-blog/assets/js/68.ef92ba52.js"><link rel="prefetch" href="/VuePress-blog/assets/js/69.b1700696.js"><link rel="prefetch" href="/VuePress-blog/assets/js/7.4e3bdcaf.js"><link rel="prefetch" href="/VuePress-blog/assets/js/70.a0687351.js"><link rel="prefetch" href="/VuePress-blog/assets/js/71.3a14e318.js"><link rel="prefetch" href="/VuePress-blog/assets/js/72.99b53005.js"><link rel="prefetch" href="/VuePress-blog/assets/js/73.897a92b9.js"><link rel="prefetch" href="/VuePress-blog/assets/js/74.b16f1719.js"><link rel="prefetch" href="/VuePress-blog/assets/js/75.002964da.js"><link rel="prefetch" href="/VuePress-blog/assets/js/76.7624e778.js"><link rel="prefetch" href="/VuePress-blog/assets/js/77.e00d405d.js"><link rel="prefetch" href="/VuePress-blog/assets/js/78.95645db5.js"><link rel="prefetch" href="/VuePress-blog/assets/js/79.bba0d631.js"><link rel="prefetch" href="/VuePress-blog/assets/js/8.d7f6aae7.js"><link rel="prefetch" href="/VuePress-blog/assets/js/80.b728c7d7.js"><link rel="prefetch" href="/VuePress-blog/assets/js/81.41b1a44a.js"><link rel="prefetch" href="/VuePress-blog/assets/js/82.c5fe8c82.js"><link rel="prefetch" href="/VuePress-blog/assets/js/83.b899cdd2.js"><link rel="prefetch" href="/VuePress-blog/assets/js/84.f92dd1f0.js"><link rel="prefetch" href="/VuePress-blog/assets/js/85.30ecf40f.js"><link rel="prefetch" href="/VuePress-blog/assets/js/86.62a793c0.js"><link rel="prefetch" href="/VuePress-blog/assets/js/87.97927fa1.js"><link rel="prefetch" href="/VuePress-blog/assets/js/88.f65e94f8.js"><link rel="prefetch" href="/VuePress-blog/assets/js/89.dd682117.js"><link rel="prefetch" href="/VuePress-blog/assets/js/9.2af41852.js"><link rel="prefetch" href="/VuePress-blog/assets/js/90.437e6ec1.js"><link rel="prefetch" href="/VuePress-blog/assets/js/91.577f36e9.js"><link rel="prefetch" href="/VuePress-blog/assets/js/92.7c4d870f.js"><link rel="prefetch" href="/VuePress-blog/assets/js/93.9cfe8160.js"><link rel="prefetch" href="/VuePress-blog/assets/js/94.88b6a333.js"><link rel="prefetch" href="/VuePress-blog/assets/js/95.1ba03060.js"><link rel="prefetch" href="/VuePress-blog/assets/js/96.2693d156.js"><link rel="prefetch" href="/VuePress-blog/assets/js/97.49968a31.js"><link rel="prefetch" href="/VuePress-blog/assets/js/98.71a6785c.js"><link rel="prefetch" href="/VuePress-blog/assets/js/99.b7ba0c42.js">
    <link rel="stylesheet" href="/VuePress-blog/assets/css/0.styles.f7cbc213.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/VuePress-blog/" class="home-link router-link-active"><!----> <span class="site-name">吴起的个人网站</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="文章转载" class="dropdown-title"><span class="title">文章转载</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/VuePress-blog/文章转载/" class="nav-link">
  首页
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/文章转载/Linux常见命令/" class="nav-link">
  Linux常见命令
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/文章转载/Linux常用软件/" class="nav-link">
  Linux常用软件
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/文章转载/docker/" class="nav-link">
  docker
</a></li><li class="dropdown-item"><h4>
          Vim
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/VuePress-blog/文章转载/Vim/vim文章/" class="nav-link">
  vim文章
</a></li><li class="dropdown-subitem"><a href="/VuePress-blog/文章转载/Vim/vim配置/" class="nav-link">
  vim配置
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="常见问题" class="dropdown-title"><span class="title">常见问题</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/VuePress-blog/常见问题/客户端科学上网/" class="nav-link">
  客户端科学上网
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/常见问题/命令行科学上网/" class="nav-link">
  命令行科学上网
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/常见问题/镜像加速大全/" class="nav-link">
  镜像加速大全
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/常见问题/Git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/常见问题/vim/" class="nav-link">
  vim
</a></li><li class="dropdown-item"><h4>
          Pyhton
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/VuePress-blog/常见问题/Python/" class="nav-link">
  Pyhton
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="python" class="dropdown-title"><span class="title">python</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/VuePress-blog/Python/" class="nav-link">
  首页
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/Python/最新转载/" class="nav-link">
  最新转载
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/Python/爬虫案例/" class="nav-link">
  爬虫案例
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="个人原创" class="dropdown-title"><span class="title">个人原创</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/VuePress-blog/个人原创/" class="nav-link">
  个人原创
</a></li></ul></div></div> <a href="https://github.com/solider245/VuePress-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    Repo
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="文章转载" class="dropdown-title"><span class="title">文章转载</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/VuePress-blog/文章转载/" class="nav-link">
  首页
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/文章转载/Linux常见命令/" class="nav-link">
  Linux常见命令
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/文章转载/Linux常用软件/" class="nav-link">
  Linux常用软件
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/文章转载/docker/" class="nav-link">
  docker
</a></li><li class="dropdown-item"><h4>
          Vim
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/VuePress-blog/文章转载/Vim/vim文章/" class="nav-link">
  vim文章
</a></li><li class="dropdown-subitem"><a href="/VuePress-blog/文章转载/Vim/vim配置/" class="nav-link">
  vim配置
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="常见问题" class="dropdown-title"><span class="title">常见问题</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/VuePress-blog/常见问题/客户端科学上网/" class="nav-link">
  客户端科学上网
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/常见问题/命令行科学上网/" class="nav-link">
  命令行科学上网
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/常见问题/镜像加速大全/" class="nav-link">
  镜像加速大全
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/常见问题/Git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/常见问题/vim/" class="nav-link">
  vim
</a></li><li class="dropdown-item"><h4>
          Pyhton
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/VuePress-blog/常见问题/Python/" class="nav-link">
  Pyhton
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="python" class="dropdown-title"><span class="title">python</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/VuePress-blog/Python/" class="nav-link">
  首页
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/Python/最新转载/" class="nav-link">
  最新转载
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/Python/爬虫案例/" class="nav-link">
  爬虫案例
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="个人原创" class="dropdown-title"><span class="title">个人原创</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/VuePress-blog/个人原创/" class="nav-link">
  个人原创
</a></li></ul></div></div> <a href="https://github.com/solider245/VuePress-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    Repo
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>docker</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/VuePress-blog/文章转载/docker/Docker Compose保持容器运行.html" class="sidebar-link">Docker Compose保持容器运行</a></li><li><a href="/VuePress-blog/文章转载/docker/Docker 容器镜像及其使用.html" class="sidebar-link">Docker 容器镜像及其使用</a></li><li><a href="/VuePress-blog/文章转载/docker/Docker 构建脚本 Dockerfile 指令全解析.html" class="sidebar-link">Docker 构建脚本 Dockerfile 指令全解析</a></li><li><a href="/VuePress-blog/文章转载/docker/Docker---Dockerfile 详解.html" class="sidebar-link">Docker---Dockerfile 详解</a></li><li><a href="/VuePress-blog/文章转载/docker/Dockerfile 基础实战：构建基础的 ubuntu14.04 镜像.html" class="sidebar-link">Dockerfile 基础实战：构建基础的 ubuntu14.04 镜像</a></li><li><a href="/VuePress-blog/文章转载/docker/Dockerfile官方参考.html" class="sidebar-link">Dockerfile官方参考</a></li><li><a href="/VuePress-blog/文章转载/docker/Dockerfile指令汇总及解析.html" class="sidebar-link">Dockerfile指令汇总及解析</a></li><li><a href="/VuePress-blog/文章转载/docker/Docker开发入门.html" class="sidebar-link">Docker开发入门</a></li><li><a href="/VuePress-blog/文章转载/docker/Dry官方按键备忘.html" class="sidebar-link">Dry官方按键备忘</a></li><li><a href="/VuePress-blog/文章转载/docker/Portainer一个轻量级的Docker环境管理UI.html" class="sidebar-link">Portainer一个轻量级的Docker环境管理UI</a></li><li><a href="/VuePress-blog/%E6%96%87%E7%AB%A0%E8%BD%AC%E8%BD%BD/docker/" aria-current="page" class="sidebar-link">转载docker文章的目录</a></li><li><a href="/VuePress-blog/文章转载/docker/Ubuntu 安装 Docker CE.html" class="sidebar-link">Ubuntu 安装 Docker CE</a></li><li><a href="/VuePress-blog/文章转载/docker/docker-Compose官方教程.html" class="sidebar-link">docker-Compose官方教程</a></li><li><a href="/VuePress-blog/文章转载/docker/dockerFile介绍.html" class="sidebar-link">dockerFile介绍</a></li><li><a href="/VuePress-blog/文章转载/docker/docker运行shell脚本问题.html" class="sidebar-link">docker运行shell脚本问题</a></li><li><a href="/VuePress-blog/文章转载/docker/mac 下使用 Docker 搭建 ubuntu 环境.html" class="sidebar-link">mac 下使用 Docker 搭建 ubuntu 环境</a></li><li><a href="/VuePress-blog/文章转载/docker/一个node入门Dockfile.html" class="sidebar-link">一个node入门Dockfile</a></li><li><a href="/VuePress-blog/文章转载/docker/不正宗 docker 入门教程-构建一个镜像.html" class="sidebar-link">不正宗 docker 入门教程-构建一个镜像</a></li><li><a href="/VuePress-blog/文章转载/docker/从镜像历史记录逆向分析出Dockerfile.html" class="sidebar-link">从镜像历史记录逆向分析出Dockerfile</a></li><li><a href="/VuePress-blog/文章转载/docker/使用 BuildKit 构建镜像.html" class="sidebar-link">使用 BuildKit 构建镜像</a></li><li><a href="/VuePress-blog/文章转载/docker/借助Dockerize更好的Docker体验.html" class="sidebar-link">借助Dockerize更好的Docker体验</a></li><li><a href="/VuePress-blog/文章转载/docker/在Dockerfile中运行脚本.html" class="sidebar-link">在Dockerfile中运行脚本</a></li><li><a href="/VuePress-blog/文章转载/docker/如何在Ubuntu 16.04上以干式方式管理和监视Docker容器.html" class="sidebar-link">如何在Ubuntu 16.04上以干式方式管理和监视Docker容器</a></li><li><a href="/VuePress-blog/文章转载/docker/如何在Ubuntu 20.04 LTS上使用Dockerfile创建Docker映像.html" class="active sidebar-link">如何在Ubuntu 20.04 LTS上使用Dockerfile创建Docker映像</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/VuePress-blog/文章转载/docker/如何在Ubuntu 20.04 LTS上使用Dockerfile创建Docker映像.html#dockerfile命令简介" class="sidebar-link">Dockerfile命令简介</a></li><li class="sidebar-sub-header"><a href="/VuePress-blog/文章转载/docker/如何在Ubuntu 20.04 LTS上使用Dockerfile创建Docker映像.html#第1步-在ubuntu-20-04上安装docker" class="sidebar-link">第1步\-在Ubuntu 20.04上安装Docker</a></li><li class="sidebar-sub-header"><a href="/VuePress-blog/文章转载/docker/如何在Ubuntu 20.04 LTS上使用Dockerfile创建Docker映像.html#第2步-创建dockerfile和其他配置" class="sidebar-link">第2步\-创建Dockerfile和其他配置</a></li><li class="sidebar-sub-header"><a href="/VuePress-blog/文章转载/docker/如何在Ubuntu 20.04 LTS上使用Dockerfile创建Docker映像.html#第3步-建立新的自定义并运行新的容器" class="sidebar-link">第3步\-建立新的自定义并运行新的容器</a></li><li class="sidebar-sub-header"><a href="/VuePress-blog/文章转载/docker/如何在Ubuntu 20.04 LTS上使用Dockerfile创建Docker映像.html#步骤4-测试" class="sidebar-link">步骤4\-测试</a></li></ul></li><li><a href="/VuePress-blog/文章转载/docker/如何编写最佳的Dockerfile.html" class="sidebar-link">如何编写最佳的Dockerfile</a></li><li><a href="/VuePress-blog/文章转载/docker/官方下一代Docker镜像构建神器 -- BuildKit.html" class="sidebar-link">官方下一代Docker镜像构建神器 -- BuildKit</a></li><li><a href="/VuePress-blog/文章转载/docker/对传统应用进行容器化改造（译）.html" class="sidebar-link">对传统应用进行容器化改造（译）</a></li><li><a href="/VuePress-blog/文章转载/docker/应用容器化&amp;DevOps之路.html" class="sidebar-link">应用容器化&amp;DevOps之路</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p></p><div class="table-of-contents"><ul><li><a href="#dockerfile命令简介">Dockerfile命令简介</a></li><li><a href="#第1步-在ubuntu-20-04上安装docker">第1步\-在Ubuntu 20.04上安装Docker</a></li><li><a href="#第2步-创建dockerfile和其他配置">第2步\-创建Dockerfile和其他配置</a></li><li><a href="#第3步-建立新的自定义并运行新的容器">第3步\-建立新的自定义并运行新的容器</a></li><li><a href="#步骤4-测试">步骤4\-测试</a></li></ul></div>
Docker是操作系统级虚拟化，主要用于开发人员和系统管理员。 Docker使在隔离环境中创建和部署应用程序变得更加容易。<p></p> <p>Dockerfile是一个脚本，其中包含命令和指令的集合，这些命令和指令将在Docker环境中按顺序自动执行以构建新的Docker映像。</p> <p>在本教程中，我们将向您展示如何使用Dockerfile创建自己的Docker映像。 我们将解释与Dockerfile相关的详细信息，以使您能够构建自己的Docker映像。</p> <p><strong>先决条件</strong></p> <p>对于本指南，我们将使用具有1GB RAM，25GB可用磁盘空间和2个CPU的Ubuntu 20.04。 另外，我们将使用Ubuntu 20.04作为基础映像来构建自定义Docker映像。</p> <h2 id="dockerfile命令简介">Dockerfile命令简介</h2> <p>Dockerfile是一个脚本，其中包含用于构建Docker映像的所有命令。 Dockerfile包含将用于通过“ docker build”命令创建Docker映像的所有指令。</p> <p>在创建第一个Dockerfile之前，您应该熟悉Dockerfile指令。 在您必须知道的一些Dockerfile指令下面。</p> <p><strong>从</strong></p> <p>设置要创建的新图像的基础图像。 FROM指令将初始化新的构建阶段，并且必须位于Dockerfile的顶部。</p> <p><strong>标签</strong></p> <p>通过此指令，您可以添加有关Docker映像的其他信息，例如版本，描述，维护程序等。LABEL指令是一个键值对，可用于添加多个标签和多行值。</p> <p><strong>跑</strong></p> <p>该指令用于在Docker映像的构建过程中执行命令。 您可以安装Docker映像所需的其他软件包。</p> <p><strong>加</strong></p> <p>ADD指令用于将文件，目录或远程文件从URL复制到Docker映像，从“ src”复制到绝对路径“ dest”。 另外，您可以设置文件的默认所有权。</p> <p><strong>ENV</strong></p> <p>ENV指令用于定义一个环境变量，该环境变量可以在构建阶段使用，也可以内联替换。</p> <p><strong>CMD</strong></p> <p>CMD指令用于定义运行容器时要执行的默认命令。 并且Dockerfile只能包含一个CMD指令，如果有多个CMD，则将运行最后一个CMD指令。</p> <p><strong>暴露</strong>广告</p> <p>该指令用于在运行时在特定网络端口上公开容器端口。 公开的默认协议为TCP，但您可以指定TCP还是UDP。</p> <p><strong>ARG</strong></p> <p>ARG指令用于定义用户可以在构建时传递的变量。 您可以在构建期间使用'--build-arg variable = value'选项在docker'build command'中使用此指令，并且可以通过Dockerfile进行传递。 另外，您可以在Dockerfile上使用多个ARG。</p> <p><strong>入口点</strong></p> <p>ENTRYPOINT指令用于定义容器运行时将执行的第一个和默认命令。 定义命令以使用ENTRYPOINT指令启动您的应用程序。 广告</p> <p><strong>工作目录</strong></p> <p>WORKDIR指令用于定义Docker映像的默认工作目录。 RUN，CMD，ENTRYPOINT和ADD指令遵循WORKDIR指令。 您可以在Dockerfile上添加多个WORKDIR指令，如果该指令不存在，它将自动创建。</p> <p><strong>用户</strong></p> <p>USER指令用于定义运行映像时的默认用户或gid。 RUN，CMD和ENTRYPOINT遵循Dockerfile中的USER指令。</p> <p><strong>卷</strong></p> <p>VOLUME指令广告，用于启用容器和主机之间的访问/链接目录。</p> <p>现在，让我们开始创建第一个Dockerfile。</p> <h2 id="第1步-在ubuntu-20-04上安装docker">第1步-在Ubuntu 20.04上安装Docker</h2> <p>在创建Dockerfile之前，我们将Docker安装到我们的Ubuntu 20.04系统上，该系统默认在Ubuntu FocalFossa存储库中可用。</p> <p>更新Ubuntu存储库中的所有软件包列表，并使用以下apt命令安装Docker。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>sudo apt updatesudo apt install docker.io
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>完成所有安装后，启动Docker服务并将其添加到系统引导中。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>systemctl start dockersystemctl enable docker
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>现在，使用以下命令检查Docker服务。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>systemctl status docker
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Docker服务已在Ubuntu 20.04上启动并运行。</p> <p><a href="https://www.howtoforge.com/images/how-to-create-docker-images-with-dockerfile-20-04/big/1.png" target="_blank" rel="noopener noreferrer"><img src="https://www.howtoforge.com/images/how-to-create-docker-images-with-dockerfile-20-04/1.png?ezimgfmt=rs:750x216/rscb1/ng:webp/ngcb1" alt="启动Docker服务"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>接下来，运行以下docker命令以确保安装正确。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker run hello-world
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>以下是您将获得的结果。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>Hello from Docker!This message shows that your installation appears to be working correctly.To generate this message, Docker took the following steps: 1. The Docker client contacted the Docker daemon. 2. The Docker daemon pulled the &quot;hello-world&quot; image from the Docker Hub.    (amd64) 3. The Docker daemon created a new container from that image which runs the    executable that produces the output you are currently reading. 4. The Docker daemon streamed that output to the Docker client, which sent it    to your terminal.To try something more ambitious, you can run an Ubuntu container with: $ docker run -it ubuntu bashShare images, automate workflows, and more with a free Docker ID: https://hub.docker.com/For more examples and ideas, visit: https://docs.docker.com/get-started/
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>可以看到，您从Docker收到Hello World消息，并且在Ubuntu 20.04上的Docker安装已成功完成。</p> <h2 id="第2步-创建dockerfile和其他配置">第2步-创建Dockerfile和其他配置</h2> <p>在这一步中，我们将向您展示如何使用Dockerfile为您的应用程序构建自定义Docker映像。 我们将基于Ubuntu 20.04映像为PHP-FPM和Nginx服务创建一个新的自定义Docker映像，然后使用简单的phpinfo脚本运行新容器。</p> <p>首先，创建一个新的项目目录并创建一个空的Dockerfile。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>mkdir -p nginx-image; cd nginx-image/touch Dockerfile
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>现在使用您自己的编辑器编辑“ Dockerfile”脚本（在本示例中，我们使用vim）。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>vim Dockerfile
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>在该行的顶部，使用FROM指令添加基本映像Ubuntu 20.04映像，如下所示。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>#Download base image ubuntu 20.04
FROM ubuntu:20.04
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>现在，使用LABEL指令添加有关自定义图像的详细信息。</p> <div class="language-docker line-numbers-mode"><pre class="language-docker"><code><span class="token comment"># LABEL about the custom image</span>
<span class="token keyword">LABEL</span> maintainer=<span class="token string">&quot;admin@sysadminjournal.com&quot;</span>
<span class="token keyword">LABEL</span> version=<span class="token string">&quot;0.1&quot;</span>
<span class="token keyword">LABEL</span> description=<span class="token string">&quot;This is custom Docker Image for \
the PHP-FPM and Nginx Services.&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>对于apt软件包安装，我们将使用环境变量'DEBIAN_FRONTEND = noninteractive'跳过任何交互式的安装后步骤。</p> <div class="language-docker line-numbers-mode"><pre class="language-docker"><code><span class="token comment"># Disable Prompt During Packages Installation</span>
<span class="token keyword">ARG</span> DEBIAN_FRONTEND=noninteractive
<span class="token keyword">ARG</span> DEBIAN_FRONTEND=noninteractive
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>接下来，在安装任何软件包之前运行“ apt update”命令。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># Update Ubuntu Software repository</span>
RUN <span class="token function">apt</span> update

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>现在安装Nginx，PHP-FPM和超级用户软件包。 完成所有安装后，请删除所有程序包缓存以减小自定义映像的大小。</p> <div class="language-docker line-numbers-mode"><pre class="language-docker"><code><span class="token comment"># Install nginx, php-fpm and supervisord from ubuntu repository</span>
<span class="token keyword">RUN</span> apt install <span class="token punctuation">-</span>y nginx php<span class="token punctuation">-</span>fpm supervisor &amp;&amp; \
    rm <span class="token punctuation">-</span>rf /var/lib/apt/lists/* &amp;&amp; \
    apt clean
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>定义可以在自定义映像上传递的新环境变量。</p> <div class="language-docker line-numbers-mode"><pre class="language-docker"><code><span class="token comment">#Define the ENV variable</span>
<span class="token keyword">ENV</span> nginx_vhost /etc/nginx/sites<span class="token punctuation">-</span>available/default
<span class="token keyword">ENV</span> php_conf /etc/php/7.4/fpm/php.ini
<span class="token keyword">ENV</span> nginx_conf /etc/nginx/nginx.conf
<span class="token keyword">ENV</span> supervisor_conf /etc/supervisor/supervisord.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>现在将Nginx默认配置复制到'nginx_vhost'变量，将php.ini配置文件中的PHP配置'cgi.fix_pathinfo = 1'替换为'cgi.fix_pathinfo = 0'，然后将'daemon off'选项添加到默认的“ nginx_conf”变量。</p> <div class="language-docker line-numbers-mode"><pre class="language-docker"><code><span class="token comment"># Enable PHP-fpm on nginx virtualhost configuration</span>
<span class="token keyword">COPY</span> default $<span class="token punctuation">{</span>nginx_vhost<span class="token punctuation">}</span>
<span class="token keyword">RUN</span> sed <span class="token punctuation">-</span>i <span class="token punctuation">-</span>e <span class="token string">'s/;cgi.fix_pathinfo=1/cgi.fix_pathinfo=0/g'</span> $<span class="token punctuation">{</span>php_conf<span class="token punctuation">}</span> &amp;&amp; \
    echo <span class="token string">&quot;\ndaemon off;&quot;</span> <span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span> $<span class="token punctuation">{</span>nginx_conf<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>将定制的监管配置复制到“ supervisor_conf”变量。</p> <div class="language-docker line-numbers-mode"><pre class="language-docker"><code><span class="token comment">#Copy supervisor configuration</span>
<span class="token keyword">COPY</span> supervisord.conf $<span class="token punctuation">{</span>supervisor_conf<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>为PHP-FPM sock文件创建一个新目录，将Web根目录“ / var / www / html”和PHP-FPM目录“ / run / php”的所有权更改为默认用户“ www-data”。</p> <div class="language-docker line-numbers-mode"><pre class="language-docker"><code><span class="token keyword">RUN</span> mkdir <span class="token punctuation">-</span>p /run/php &amp;&amp; \
    chown <span class="token punctuation">-</span>R www<span class="token punctuation">-</span>data<span class="token punctuation">:</span>www<span class="token punctuation">-</span>data /var/www/html &amp;&amp; \
    chown <span class="token punctuation">-</span>R www<span class="token punctuation">-</span>data<span class="token punctuation">:</span>www<span class="token punctuation">-</span>data /run/php
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>定义自定义映像的卷，以便我们可以将所有这些目录挂载到主机上。</p> <div class="language-docker line-numbers-mode"><pre class="language-docker"><code><span class="token comment"># Volume configuration</span>
<span class="token keyword">VOLUME</span> <span class="token punctuation">[</span><span class="token string">&quot;/etc/nginx/sites-enabled&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/etc/nginx/certs&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/etc/nginx/conf.d&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/var/log/nginx&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/var/www/html&quot;</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>现在添加“ start.sh”脚本，并使用CMD指令定义默认的容器命令，如下所示。</p> <div class="language-docker line-numbers-mode"><pre class="language-docker"><code><span class="token comment"># Copy start.sh script and define default command for the container</span>
<span class="token keyword">COPY</span> start.sh /start.sh
<span class="token keyword">CMD</span> <span class="token punctuation">[</span><span class="token string">&quot;./start.sh&quot;</span><span class="token punctuation">]</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>最后，使用EXPOSE指令打开容器上的默认HTTP和HTTPS端口。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code># Expose Port for the Application EXPOSE 80 443
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>保存并关闭。 广告</p> <p>以下是我们刚刚创建的完整Dockerfile脚本。</p> <div class="language-docker line-numbers-mode"><pre class="language-docker"><code><span class="token comment"># Download base image ubuntu 20.04</span>
<span class="token keyword">FROM</span> ubuntu<span class="token punctuation">:</span>20.04

<span class="token comment"># LABEL about the custom image</span>
<span class="token keyword">LABEL</span> maintainer=<span class="token string">&quot;admin@sysadminjournal.com&quot;</span>
<span class="token keyword">LABEL</span> version=<span class="token string">&quot;0.1&quot;</span>
<span class="token keyword">LABEL</span> description=<span class="token string">&quot;This is custom Docker Image for \
the PHP-FPM and Nginx Services.&quot;</span>

<span class="token comment"># Disable Prompt During Packages Installation</span>
<span class="token keyword">ARG</span> DEBIAN_FRONTEND=noninteractive

<span class="token comment"># Update Ubuntu Software repository</span>
<span class="token keyword">RUN</span> apt update

<span class="token comment"># Install nginx, php-fpm and supervisord from ubuntu repository</span>
<span class="token keyword">RUN</span> apt install <span class="token punctuation">-</span>y nginx php<span class="token punctuation">-</span>fpm supervisor &amp;&amp; \
    rm <span class="token punctuation">-</span>rf /var/lib/apt/lists/* &amp;&amp; \
    apt clean
    
<span class="token comment"># Define the ENV variable</span>
<span class="token keyword">ENV</span> nginx_vhost /etc/nginx/sites<span class="token punctuation">-</span>available/default
<span class="token keyword">ENV</span> php_conf /etc/php/7.4/fpm/php.ini
<span class="token keyword">ENV</span> nginx_conf /etc/nginx/nginx.conf
<span class="token keyword">ENV</span> supervisor_conf /etc/supervisor/supervisord.conf

<span class="token comment"># Enable PHP-fpm on nginx virtualhost configuration</span>
<span class="token keyword">COPY</span> default $<span class="token punctuation">{</span>nginx_vhost<span class="token punctuation">}</span>
<span class="token keyword">RUN</span> sed <span class="token punctuation">-</span>i <span class="token punctuation">-</span>e <span class="token string">'s/;cgi.fix_pathinfo=1/cgi.fix_pathinfo=0/g'</span> $<span class="token punctuation">{</span>php_conf<span class="token punctuation">}</span> &amp;&amp; \
    echo <span class="token string">&quot;\ndaemon off;&quot;</span> <span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span> $<span class="token punctuation">{</span>nginx_conf<span class="token punctuation">}</span>
    
<span class="token comment"># Copy supervisor configuration</span>
<span class="token keyword">COPY</span> supervisord.conf $<span class="token punctuation">{</span>supervisor_conf<span class="token punctuation">}</span>

<span class="token keyword">RUN</span> mkdir <span class="token punctuation">-</span>p /run/php &amp;&amp; \
    chown <span class="token punctuation">-</span>R www<span class="token punctuation">-</span>data<span class="token punctuation">:</span>www<span class="token punctuation">-</span>data /var/www/html &amp;&amp; \
    chown <span class="token punctuation">-</span>R www<span class="token punctuation">-</span>data<span class="token punctuation">:</span>www<span class="token punctuation">-</span>data /run/php
    
<span class="token comment"># Volume configuration</span>
<span class="token keyword">VOLUME</span> <span class="token punctuation">[</span><span class="token string">&quot;/etc/nginx/sites-enabled&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/etc/nginx/certs&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/etc/nginx/conf.d&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/var/log/nginx&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;/var/www/html&quot;</span><span class="token punctuation">]</span>

<span class="token comment"># Copy start.sh script and define default command for the container</span>
<span class="token keyword">COPY</span> start.sh /start.sh
<span class="token keyword">CMD</span> <span class="token punctuation">[</span><span class="token string">&quot;./start.sh&quot;</span><span class="token punctuation">]</span>

<span class="token comment"># Expose Port for the Application </span>
<span class="token keyword">EXPOSE</span> 80 443
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br></div></div><p>接下来，我们将为Nginx，supervisor和start.sh脚本创建一个新的附加配置。</p> <p>“默认” Nginx虚拟主机配置将包含PHP-FPM的部分。 实际上，您可以使用“自定义”映像运行PHP脚本，而无需进行任何更改。</p> <p>使用编辑器创建一个新的Nginx“默认”虚拟主机配置。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>vim default
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>将以下配置粘贴到其中。</p> <div class="language-vim line-numbers-mode"><pre class="language-vim"><code>server <span class="token punctuation">{</span>
    listen <span class="token number">80</span> default_server<span class="token punctuation">;</span>
 
    root <span class="token operator">/</span>var<span class="token operator">/</span>www<span class="token operator">/</span>html<span class="token punctuation">;</span>
    index index<span class="token operator">.</span>html index<span class="token operator">.</span>htm index<span class="token operator">.</span>nginx<span class="token operator">-</span>debian<span class="token operator">.</span>html<span class="token punctuation">;</span>
 
    server_name _<span class="token punctuation">;</span>
 
    location <span class="token operator">/</span> <span class="token punctuation">{</span>
        try_files $uri $uri<span class="token operator">/</span> <span class="token operator">=</span><span class="token number">404</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
 
    location ~ \<span class="token operator">.</span>php$ <span class="token punctuation">{</span>
        <span class="token builtin">include</span> snippets<span class="token operator">/</span>fastcgi<span class="token operator">-</span>php<span class="token operator">.</span><span class="token keyword">conf</span><span class="token punctuation">;</span>
        fastcgi_pass unix<span class="token punctuation">:</span><span class="token operator">/</span>run<span class="token operator">/</span>php<span class="token operator">/</span>php7<span class="token operator">.</span><span class="token number">4</span><span class="token operator">-</span>fpm<span class="token operator">.</span>sock<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>保存并关闭。</p> <p>接下来，我们将创建“ supervisrod.conf”配置，其中包含将自动运行的Nginx和PHP-FPM程序。</p> <p>使用编辑器创建“ supervisrod.conf”文件。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>vim supervisord.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>将以下配置粘贴到其中。</p> <div class="language-vim line-numbers-mode"><pre class="language-vim"><code><span class="token punctuation">[</span>unix_http_server<span class="token punctuation">]</span>
<span class="token keyword">file</span><span class="token operator">=</span><span class="token operator">/</span>dev<span class="token operator">/</span><span class="token builtin">shm</span><span class="token operator">/</span>supervisor<span class="token operator">.</span>sock   <span class="token punctuation">;</span> <span class="token punctuation">(</span>the <span class="token builtin">path</span> <span class="token keyword">to</span> the socket <span class="token keyword">file</span><span class="token punctuation">)</span>
 
<span class="token punctuation">[</span>supervisord<span class="token punctuation">]</span>
logfile<span class="token operator">=</span><span class="token operator">/</span>var<span class="token operator">/</span>log<span class="token operator">/</span>supervisord<span class="token operator">.</span>log <span class="token punctuation">;</span> <span class="token punctuation">(</span>main log <span class="token keyword">file</span><span class="token punctuation">;</span>default $CWD<span class="token operator">/</span>supervisord<span class="token operator">.</span>log<span class="token punctuation">)</span>
logfile_maxbytes<span class="token operator">=</span>50MB        <span class="token punctuation">;</span> <span class="token punctuation">(</span>max main logfile bytes b4 rotation<span class="token punctuation">;</span>default 50MB<span class="token punctuation">)</span>
logfile_backups<span class="token operator">=</span><span class="token number">10</span>           <span class="token punctuation">;</span> <span class="token punctuation">(</span>num of main logfile rotation backups<span class="token punctuation">;</span>default <span class="token number">10</span><span class="token punctuation">)</span>
loglevel<span class="token operator">=</span>info                <span class="token punctuation">;</span> <span class="token punctuation">(</span>log level<span class="token punctuation">;</span>default info<span class="token punctuation">;</span> others<span class="token punctuation">:</span> <span class="token builtin">debug</span><span class="token punctuation">,</span><span class="token builtin">warn</span><span class="token punctuation">,</span>trace<span class="token punctuation">)</span>
pidfile<span class="token operator">=</span><span class="token operator">/</span>tmp<span class="token operator">/</span>supervisord<span class="token operator">.</span>pid <span class="token punctuation">;</span> <span class="token punctuation">(</span>supervisord pidfile<span class="token punctuation">;</span>default supervisord<span class="token operator">.</span>pid<span class="token punctuation">)</span>
nodaemon<span class="token operator">=</span>false               <span class="token punctuation">;</span> <span class="token punctuation">(</span>start <span class="token keyword">in</span> foreground <span class="token keyword">if</span> true<span class="token punctuation">;</span>default false<span class="token punctuation">)</span>
minfds<span class="token operator">=</span><span class="token number">1024</span>                  <span class="token punctuation">;</span> <span class="token punctuation">(</span>min<span class="token operator">.</span> avail startup <span class="token keyword">file</span> descriptors<span class="token punctuation">;</span>default <span class="token number">1024</span><span class="token punctuation">)</span>
minprocs<span class="token operator">=</span><span class="token number">200</span>                 <span class="token punctuation">;</span> <span class="token punctuation">(</span>min<span class="token operator">.</span> avail process descriptors<span class="token punctuation">;</span>default <span class="token number">200</span><span class="token punctuation">)</span>
user<span class="token operator">=</span>root             <span class="token punctuation">;</span>

<span class="token punctuation">[</span>rpcinterface<span class="token punctuation">:</span>supervisor<span class="token punctuation">]</span>
supervisor<span class="token operator">.</span>rpcinterface_factory <span class="token operator">=</span> supervisor<span class="token operator">.</span>rpcinterface<span class="token punctuation">:</span>make_main_rpcinterface
 
<span class="token punctuation">[</span>supervisorctl<span class="token punctuation">]</span>
serverurl<span class="token operator">=</span>unix<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span><span class="token operator">/</span>dev<span class="token operator">/</span><span class="token builtin">shm</span><span class="token operator">/</span>supervisor<span class="token operator">.</span>sock <span class="token punctuation">;</span> use a unix<span class="token punctuation">:</span><span class="token operator">/</span><span class="token operator">/</span> URL  <span class="token keyword">for</span> a unix socket
 
<span class="token punctuation">[</span><span class="token builtin">include</span><span class="token punctuation">]</span>
<span class="token keyword">files</span> <span class="token operator">=</span> <span class="token operator">/</span>etc<span class="token operator">/</span>supervisor<span class="token operator">/</span><span class="token keyword">conf</span><span class="token operator">.</span><span class="token keyword">d</span><span class="token operator">/</span><span class="token operator">*</span><span class="token operator">.</span><span class="token keyword">conf</span>
 
<span class="token punctuation">[</span>program<span class="token punctuation">:</span>php<span class="token operator">-</span>fpm7<span class="token operator">.</span><span class="token number">4</span><span class="token punctuation">]</span>
command<span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>sbin<span class="token operator">/</span>php<span class="token operator">-</span>fpm7<span class="token operator">.</span><span class="token number">4</span> <span class="token operator">-</span>F
numprocs<span class="token operator">=</span><span class="token number">1</span>
autostart<span class="token operator">=</span>true
autorestart<span class="token operator">=</span>true
 
<span class="token punctuation">[</span>program<span class="token punctuation">:</span>nginx<span class="token punctuation">]</span>
command<span class="token operator">=</span><span class="token operator">/</span>usr<span class="token operator">/</span>sbin<span class="token operator">/</span>nginx
numprocs<span class="token operator">=</span><span class="token number">1</span>
autostart<span class="token operator">=</span>true
autorestart<span class="token operator">=</span>true
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br></div></div><p>保存并关闭。</p> <p>现在，使用t = your编辑器创建“ start.sh”脚本，该脚本将包含启动的监管命令。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>vim start.sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>将以下配置粘贴到其中。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token shebang important">#!/bin/sh</span>
/usr/bin/supervisord -n -c /etc/supervisor/supervisord.conf
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>保存并关闭。</p> <p>使“ start.sh”脚本可执行。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>chmod +x start.sh
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>结果，已经创建了自定义Docker映像的所有配置，以下是我们创建的所有配置。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>tree .
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>现在，我们准备基于这些配置创建一个新的自定义映像。</p> <p><a href="https://www.howtoforge.com/images/how-to-create-docker-images-with-dockerfile-20-04/big/2.png" target="_blank" rel="noopener noreferrer"><img src="https://www.howtoforge.com/images/how-to-create-docker-images-with-dockerfile-20-04/2.png?ezimgfmt=rs:662x211/rscb1/ng:webp/ngcb1" alt="检查Docker服务状态"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <h2 id="第3步-建立新的自定义并运行新的容器">第3步-建立新的自定义并运行新的容器</h2> <p>要创建Docker自定义映像，请转到项目目录“ nginx-image”，然后运行“ docker build”命令，如下所示。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker build -t nginx-image .
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>该命令将下载基本映像Ubuntu 20.04，并创建一个名为'nginx-image的新自定义映像。</p> <p>完成所有过程后，使用以下命令检查系统上可用的Docker映像列表。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker image ls
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>以下是您将获得的结果。</p> <p><a href="https://www.howtoforge.com/images/how-to-create-docker-images-with-dockerfile-20-04/big/3.png" target="_blank" rel="noopener noreferrer"><img src="https://www.howtoforge.com/images/how-to-create-docker-images-with-dockerfile-20-04/3.png?ezimgfmt=rs:750x157/rscb1/ng:webp/ngcb1" alt="检查Docker映像"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>可以看出，已经创建了新的自定义Docker映像'nginx-image'。</p> <p>接下来，我们将基于'nginx-image'运行新的Docker容器。</p> <p>在本地计算机上，创建一个名为“ webroot”的新目录，该目录将用于存储所有Web文件。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>mkdir -p /webroot
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>现在，使用下面的docker run命令创建一个名为test-container的新容器。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker run -d -v /webroot:/var/www/html -p 8080:80 --name test-container nginx-image
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p><strong>注意：</strong></p> <ul><li>--name test-container nginx-image =我们基于docker image'nginx-image'创建一个名称为'test-container'的新容器。</li> <li>-p 8080：80 =在主机上的端口8080上运行的测试容器容器。</li> <li>-v / webroot：/ var / www / html =主机上的/ webroot目录重写容器上的/ var / www / html目录。</li></ul> <p>之后，使用以下命令检查系统上所有正在运行的容器。</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>docker ps
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>以下是您将获得的结果。</p> <p><a href="https://www.howtoforge.com/images/how-to-create-docker-images-with-dockerfile-20-04/big/4.png" target="_blank" rel="noopener noreferrer"><img src="https://www.howtoforge.com/images/how-to-create-docker-images-with-dockerfile-20-04/4.png?ezimgfmt=rs:750x144/rscb1/ng:webp/ngcb1" alt="检查正在运行的容器"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>结果，基于“ nginx-image”并暴露端口8080的名为“ test-container”的新容器已启动并正在运行。</p> <h2 id="步骤4-测试">步骤4-测试</h2> <p>为了确保容器正常运行，我们将在主机的'/ webroot'根目录上创建一个新的index.html和phpinfo文件。 因为“ / webroot”目录已装入容器目录“ / var / www / html”。</p> <p>使用以下命令在“ / webroot”目录上创建index.html文件。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">echo</span> <span class="token string">'&lt;h1&gt;Nginx and PHP-FPM 7.4 inside Docker Container with Ubuntu 20.04 Base Image&lt;/h1&gt;'</span> <span class="token operator">&gt;</span> /webroot/index.html
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>现在，使用端口8080上的curl命令测试访问您的容器。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token function">curl</span> server-ip:8080
<span class="token function">curl</span> -I server-ip:8080
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>结果，您将获得我们刚刚创建的默认index.html页面。</p> <p><a href="https://www.howtoforge.com/images/how-to-create-docker-images-with-dockerfile-20-04/big/5.png" target="_blank" rel="noopener noreferrer"><img src="https://www.howtoforge.com/images/how-to-create-docker-images-with-dockerfile-20-04/5.png?ezimgfmt=rs:750x222/rscb1/ng:webp/ngcb1" alt="创建index.html页面"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>接下来，在“ / webroot”目录上创建一个新的PHP文件“ info.php”，以确保PHP-FPM服务正在运行。</p> <p>使用以下命令创建“ info.php”文件。</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">echo</span> <span class="token string">'&lt;?php phpinfo(); ?&gt;'</span> <span class="token operator">&gt;</span> /webroot/info.php
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>接下来，打开您的Web浏览器并在端口“ 8080”后键入“ info.php”文件的路径，输入服务器IP地址。</p> <p><a href="http://server-ip:8080/info.php" target="_blank" rel="noopener noreferrer">http：// server-ip：8080 / info.php<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>现在，您将获得如下所示的phpinfo页面。</p> <p><a href="https://www.howtoforge.com/images/how-to-create-docker-images-with-dockerfile-20-04/big/6.png" target="_blank" rel="noopener noreferrer"><img src="https://www.howtoforge.com/images/how-to-create-docker-images-with-dockerfile-20-04/6.png?ezimgfmt=rs:750x436/rscb1/ng:webp/ngcb1" alt="phpinfo"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p> <p>可以看出，“ test-container”已成功加载PHP脚本。</p> <p>结果，我们成功创建了一个新的自定义Docker映像，并基于该映像运行了任何错误的新容器。</p> <p><strong>关于穆罕默德·阿鲁尔</strong></p> <p>Muhammad Arul是一名自由系统管理员和技术作家。 他在Linux环境领域工作了5年以上，他是一名开源爱好者，并且对Linux安装和故障排除充满了热情。 通常与RedHat / CentOS Linux和Ubuntu / Debian，Nginx和Apache Web服务器，Proxmox，Zimbra管理和网站优化一起使用。 当前正在学习OpenStack和容器技术。</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/solider245/VuePress-blog/edit/master/docs/文章转载/docker/如何在Ubuntu 20.04 LTS上使用Dockerfile创建Docker映像.md" target="_blank" rel="noopener noreferrer">你要教我做事咯？</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">8/3/2020, 12:27:32 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/VuePress-blog/文章转载/docker/如何在Ubuntu 16.04上以干式方式管理和监视Docker容器.html" class="prev">
        如何在Ubuntu 16.04上以干式方式管理和监视Docker容器
      </a></span> <span class="next"><a href="/VuePress-blog/文章转载/docker/如何编写最佳的Dockerfile.html">
        如何编写最佳的Dockerfile
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/VuePress-blog/assets/js/app.776d277d.js" defer></script><script src="/VuePress-blog/assets/js/2.c5117f2a.js" defer></script><script src="/VuePress-blog/assets/js/199.bbbe2ec0.js" defer></script>
  </body>
</html>
