<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>pandas使用的25个技巧 | 吴起的个人网站</title>
    <meta name="generator" content="VuePress 1.5.2">
    <link rel="icon" href="https://images-1255533533.cos.ap-shanghai.myqcloud.com/20190817214528_05c52e04cf64654248918bfc2a1f64ab.png">
    <link rel="manifest" href="/VuePress-blog/manifest.json">
    <link rel="apple-touch-icon" href="/VuePress-blog/icons/apple-touch-icon-152x152.png">
    <link rel="mask-icon" href="/VuePress-blog/icons/safari-pinned-tab.svg" color="#3eaf7c">
    <meta name="description" content="在此处添描述">
    <meta name="author" content="中箭的吴起">
    <meta name="theme-color" content="#3eaf7c">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileImage" content="/icons/msapplication-icon-144x144.png">
    <meta name="msapplication-TileColor" content="#000000">
    <link rel="preload" href="/VuePress-blog/assets/css/0.styles.f7cbc213.css" as="style"><link rel="preload" href="/VuePress-blog/assets/js/app.776d277d.js" as="script"><link rel="preload" href="/VuePress-blog/assets/js/2.c5117f2a.js" as="script"><link rel="preload" href="/VuePress-blog/assets/js/22.207eb093.js" as="script"><link rel="prefetch" href="/VuePress-blog/assets/js/10.63714471.js"><link rel="prefetch" href="/VuePress-blog/assets/js/100.1cec5f39.js"><link rel="prefetch" href="/VuePress-blog/assets/js/101.c74c6d95.js"><link rel="prefetch" href="/VuePress-blog/assets/js/102.d22dd18b.js"><link rel="prefetch" href="/VuePress-blog/assets/js/103.409414e4.js"><link rel="prefetch" href="/VuePress-blog/assets/js/104.d4463a76.js"><link rel="prefetch" href="/VuePress-blog/assets/js/105.f70dcd32.js"><link rel="prefetch" href="/VuePress-blog/assets/js/106.6516b84b.js"><link rel="prefetch" href="/VuePress-blog/assets/js/107.bdeabcbf.js"><link rel="prefetch" href="/VuePress-blog/assets/js/108.8c48acb2.js"><link rel="prefetch" href="/VuePress-blog/assets/js/109.85df5626.js"><link rel="prefetch" href="/VuePress-blog/assets/js/11.a24f4a33.js"><link rel="prefetch" href="/VuePress-blog/assets/js/110.5e67e89d.js"><link rel="prefetch" href="/VuePress-blog/assets/js/111.769d339f.js"><link rel="prefetch" href="/VuePress-blog/assets/js/112.e75614b5.js"><link rel="prefetch" href="/VuePress-blog/assets/js/113.63d1e519.js"><link rel="prefetch" href="/VuePress-blog/assets/js/114.e7a470dc.js"><link rel="prefetch" href="/VuePress-blog/assets/js/115.66e52ce5.js"><link rel="prefetch" href="/VuePress-blog/assets/js/116.4f75586b.js"><link rel="prefetch" href="/VuePress-blog/assets/js/117.c2ad36ee.js"><link rel="prefetch" href="/VuePress-blog/assets/js/118.b6e98de6.js"><link rel="prefetch" href="/VuePress-blog/assets/js/119.b57896d6.js"><link rel="prefetch" href="/VuePress-blog/assets/js/12.abc1e9a9.js"><link rel="prefetch" href="/VuePress-blog/assets/js/120.e5da282b.js"><link rel="prefetch" href="/VuePress-blog/assets/js/121.eb8b36b3.js"><link rel="prefetch" href="/VuePress-blog/assets/js/122.e3fa1136.js"><link rel="prefetch" href="/VuePress-blog/assets/js/123.d4a35a0f.js"><link rel="prefetch" href="/VuePress-blog/assets/js/124.894663d4.js"><link rel="prefetch" href="/VuePress-blog/assets/js/125.0e2df5ef.js"><link rel="prefetch" href="/VuePress-blog/assets/js/126.a62c9f29.js"><link rel="prefetch" href="/VuePress-blog/assets/js/127.c4c12b2c.js"><link rel="prefetch" href="/VuePress-blog/assets/js/128.a3d4f63f.js"><link rel="prefetch" href="/VuePress-blog/assets/js/129.a4a9c4b9.js"><link rel="prefetch" href="/VuePress-blog/assets/js/13.f38ab9c5.js"><link rel="prefetch" href="/VuePress-blog/assets/js/130.2b6974e6.js"><link rel="prefetch" href="/VuePress-blog/assets/js/131.2c254cb6.js"><link rel="prefetch" href="/VuePress-blog/assets/js/132.3c69d560.js"><link rel="prefetch" href="/VuePress-blog/assets/js/133.52d6127d.js"><link rel="prefetch" href="/VuePress-blog/assets/js/134.c2d0a90c.js"><link rel="prefetch" href="/VuePress-blog/assets/js/135.cd6b9f1a.js"><link rel="prefetch" href="/VuePress-blog/assets/js/136.1dc89614.js"><link rel="prefetch" href="/VuePress-blog/assets/js/137.f9b5cb48.js"><link rel="prefetch" href="/VuePress-blog/assets/js/138.41523b28.js"><link rel="prefetch" href="/VuePress-blog/assets/js/139.2e2adbf4.js"><link rel="prefetch" href="/VuePress-blog/assets/js/14.fb0fad09.js"><link rel="prefetch" href="/VuePress-blog/assets/js/140.112e35af.js"><link rel="prefetch" href="/VuePress-blog/assets/js/141.2e348226.js"><link rel="prefetch" href="/VuePress-blog/assets/js/142.59b5c9ef.js"><link rel="prefetch" href="/VuePress-blog/assets/js/143.a6a726d2.js"><link rel="prefetch" href="/VuePress-blog/assets/js/144.ec4a46cb.js"><link rel="prefetch" href="/VuePress-blog/assets/js/145.0b187c1e.js"><link rel="prefetch" href="/VuePress-blog/assets/js/146.b3977b6a.js"><link rel="prefetch" href="/VuePress-blog/assets/js/147.070dded6.js"><link rel="prefetch" href="/VuePress-blog/assets/js/148.703bfa68.js"><link rel="prefetch" href="/VuePress-blog/assets/js/149.eef402f6.js"><link rel="prefetch" href="/VuePress-blog/assets/js/15.a3e85e42.js"><link rel="prefetch" href="/VuePress-blog/assets/js/150.f625ba2f.js"><link rel="prefetch" href="/VuePress-blog/assets/js/151.22a07089.js"><link rel="prefetch" href="/VuePress-blog/assets/js/152.d84ba7a0.js"><link rel="prefetch" href="/VuePress-blog/assets/js/153.fb36a102.js"><link rel="prefetch" href="/VuePress-blog/assets/js/154.6b471035.js"><link rel="prefetch" href="/VuePress-blog/assets/js/155.511972d8.js"><link rel="prefetch" href="/VuePress-blog/assets/js/156.9b71a1ed.js"><link rel="prefetch" href="/VuePress-blog/assets/js/157.b1ced696.js"><link rel="prefetch" href="/VuePress-blog/assets/js/158.df097da9.js"><link rel="prefetch" href="/VuePress-blog/assets/js/159.e0884310.js"><link rel="prefetch" href="/VuePress-blog/assets/js/16.1487bb0e.js"><link rel="prefetch" href="/VuePress-blog/assets/js/160.19c256dc.js"><link rel="prefetch" href="/VuePress-blog/assets/js/161.b4a55559.js"><link rel="prefetch" href="/VuePress-blog/assets/js/162.3bf8822d.js"><link rel="prefetch" href="/VuePress-blog/assets/js/163.b02d1d5b.js"><link rel="prefetch" href="/VuePress-blog/assets/js/164.6efbaf12.js"><link rel="prefetch" href="/VuePress-blog/assets/js/165.ec61fd46.js"><link rel="prefetch" href="/VuePress-blog/assets/js/166.1aeb18e9.js"><link rel="prefetch" href="/VuePress-blog/assets/js/167.53136d07.js"><link rel="prefetch" href="/VuePress-blog/assets/js/168.860b0f88.js"><link rel="prefetch" href="/VuePress-blog/assets/js/169.1701350b.js"><link rel="prefetch" href="/VuePress-blog/assets/js/17.c965c030.js"><link rel="prefetch" href="/VuePress-blog/assets/js/170.d3659f87.js"><link rel="prefetch" href="/VuePress-blog/assets/js/171.6299f6e6.js"><link rel="prefetch" href="/VuePress-blog/assets/js/172.14097eb7.js"><link rel="prefetch" href="/VuePress-blog/assets/js/173.cd9135dd.js"><link rel="prefetch" href="/VuePress-blog/assets/js/174.4f623e28.js"><link rel="prefetch" href="/VuePress-blog/assets/js/175.1528ea30.js"><link rel="prefetch" href="/VuePress-blog/assets/js/176.4b91e0a6.js"><link rel="prefetch" href="/VuePress-blog/assets/js/177.9d0306c6.js"><link rel="prefetch" href="/VuePress-blog/assets/js/178.135bf962.js"><link rel="prefetch" href="/VuePress-blog/assets/js/179.09bf5238.js"><link rel="prefetch" href="/VuePress-blog/assets/js/18.7dab8018.js"><link rel="prefetch" href="/VuePress-blog/assets/js/180.6d15ee73.js"><link rel="prefetch" href="/VuePress-blog/assets/js/181.16ccddbf.js"><link rel="prefetch" href="/VuePress-blog/assets/js/182.a440c46e.js"><link rel="prefetch" href="/VuePress-blog/assets/js/183.3b17ab33.js"><link rel="prefetch" href="/VuePress-blog/assets/js/184.1c37fda0.js"><link rel="prefetch" href="/VuePress-blog/assets/js/185.5e91aae0.js"><link rel="prefetch" href="/VuePress-blog/assets/js/186.c040be0b.js"><link rel="prefetch" href="/VuePress-blog/assets/js/187.04c35a68.js"><link rel="prefetch" href="/VuePress-blog/assets/js/188.d3dffa3f.js"><link rel="prefetch" href="/VuePress-blog/assets/js/189.f8d1a701.js"><link rel="prefetch" href="/VuePress-blog/assets/js/19.936a56a4.js"><link rel="prefetch" href="/VuePress-blog/assets/js/190.935f2ffb.js"><link rel="prefetch" href="/VuePress-blog/assets/js/191.ce68c987.js"><link rel="prefetch" href="/VuePress-blog/assets/js/192.2cd5f900.js"><link rel="prefetch" href="/VuePress-blog/assets/js/193.4fffa096.js"><link rel="prefetch" href="/VuePress-blog/assets/js/194.763b33a4.js"><link rel="prefetch" href="/VuePress-blog/assets/js/195.41c8a153.js"><link rel="prefetch" href="/VuePress-blog/assets/js/196.18b4eb2c.js"><link rel="prefetch" href="/VuePress-blog/assets/js/197.7670df82.js"><link rel="prefetch" href="/VuePress-blog/assets/js/198.680a1a80.js"><link rel="prefetch" href="/VuePress-blog/assets/js/199.bbbe2ec0.js"><link rel="prefetch" href="/VuePress-blog/assets/js/20.1da56eb7.js"><link rel="prefetch" href="/VuePress-blog/assets/js/200.de87ea80.js"><link rel="prefetch" href="/VuePress-blog/assets/js/201.0ceace3d.js"><link rel="prefetch" href="/VuePress-blog/assets/js/202.c2800a06.js"><link rel="prefetch" href="/VuePress-blog/assets/js/203.48924c48.js"><link rel="prefetch" href="/VuePress-blog/assets/js/204.9fb412e6.js"><link rel="prefetch" href="/VuePress-blog/assets/js/205.19599c35.js"><link rel="prefetch" href="/VuePress-blog/assets/js/206.1a278f71.js"><link rel="prefetch" href="/VuePress-blog/assets/js/207.378bf6a0.js"><link rel="prefetch" href="/VuePress-blog/assets/js/208.dec187fe.js"><link rel="prefetch" href="/VuePress-blog/assets/js/209.d3326143.js"><link rel="prefetch" href="/VuePress-blog/assets/js/21.14a0c6c5.js"><link rel="prefetch" href="/VuePress-blog/assets/js/210.ed9af624.js"><link rel="prefetch" href="/VuePress-blog/assets/js/211.4c2999ee.js"><link rel="prefetch" href="/VuePress-blog/assets/js/212.b7055185.js"><link rel="prefetch" href="/VuePress-blog/assets/js/213.95bd0c97.js"><link rel="prefetch" href="/VuePress-blog/assets/js/214.be14627f.js"><link rel="prefetch" href="/VuePress-blog/assets/js/215.8532e5a4.js"><link rel="prefetch" href="/VuePress-blog/assets/js/216.956add10.js"><link rel="prefetch" href="/VuePress-blog/assets/js/217.b921800c.js"><link rel="prefetch" href="/VuePress-blog/assets/js/218.279a2533.js"><link rel="prefetch" href="/VuePress-blog/assets/js/219.941f503f.js"><link rel="prefetch" href="/VuePress-blog/assets/js/23.fcaf57a6.js"><link rel="prefetch" href="/VuePress-blog/assets/js/24.549b45ee.js"><link rel="prefetch" href="/VuePress-blog/assets/js/25.68d51b90.js"><link rel="prefetch" href="/VuePress-blog/assets/js/26.75eef058.js"><link rel="prefetch" href="/VuePress-blog/assets/js/27.e465c84f.js"><link rel="prefetch" href="/VuePress-blog/assets/js/28.ec75d8c3.js"><link rel="prefetch" href="/VuePress-blog/assets/js/29.e22ecade.js"><link rel="prefetch" href="/VuePress-blog/assets/js/3.85032dd8.js"><link rel="prefetch" href="/VuePress-blog/assets/js/30.eac685a4.js"><link rel="prefetch" href="/VuePress-blog/assets/js/31.2d55d3f1.js"><link rel="prefetch" href="/VuePress-blog/assets/js/32.9a6373e2.js"><link rel="prefetch" href="/VuePress-blog/assets/js/33.91a32ba3.js"><link rel="prefetch" href="/VuePress-blog/assets/js/34.9b401b73.js"><link rel="prefetch" href="/VuePress-blog/assets/js/35.a1a2bcde.js"><link rel="prefetch" href="/VuePress-blog/assets/js/36.405a7a4c.js"><link rel="prefetch" href="/VuePress-blog/assets/js/37.d6422337.js"><link rel="prefetch" href="/VuePress-blog/assets/js/38.9915a3eb.js"><link rel="prefetch" href="/VuePress-blog/assets/js/39.82fe0431.js"><link rel="prefetch" href="/VuePress-blog/assets/js/4.7334dde5.js"><link rel="prefetch" href="/VuePress-blog/assets/js/40.76830c33.js"><link rel="prefetch" href="/VuePress-blog/assets/js/41.d1dfc6c3.js"><link rel="prefetch" href="/VuePress-blog/assets/js/42.12371fe2.js"><link rel="prefetch" href="/VuePress-blog/assets/js/43.e3607529.js"><link rel="prefetch" href="/VuePress-blog/assets/js/44.6cec67f8.js"><link rel="prefetch" href="/VuePress-blog/assets/js/45.c20ac641.js"><link rel="prefetch" href="/VuePress-blog/assets/js/46.50d5ceed.js"><link rel="prefetch" href="/VuePress-blog/assets/js/47.6f06c416.js"><link rel="prefetch" href="/VuePress-blog/assets/js/48.08a068dc.js"><link rel="prefetch" href="/VuePress-blog/assets/js/49.e6b4bd72.js"><link rel="prefetch" href="/VuePress-blog/assets/js/5.7139b9b4.js"><link rel="prefetch" href="/VuePress-blog/assets/js/50.3cb53aad.js"><link rel="prefetch" href="/VuePress-blog/assets/js/51.0e647151.js"><link rel="prefetch" href="/VuePress-blog/assets/js/52.7ff01978.js"><link rel="prefetch" href="/VuePress-blog/assets/js/53.36a9d767.js"><link rel="prefetch" href="/VuePress-blog/assets/js/54.e6bbecb4.js"><link rel="prefetch" href="/VuePress-blog/assets/js/55.bdf81af3.js"><link rel="prefetch" href="/VuePress-blog/assets/js/56.5c96c795.js"><link rel="prefetch" href="/VuePress-blog/assets/js/57.f89a2345.js"><link rel="prefetch" href="/VuePress-blog/assets/js/58.d11b047a.js"><link rel="prefetch" href="/VuePress-blog/assets/js/59.12c9a488.js"><link rel="prefetch" href="/VuePress-blog/assets/js/6.6e6603ff.js"><link rel="prefetch" href="/VuePress-blog/assets/js/60.ba63105e.js"><link rel="prefetch" href="/VuePress-blog/assets/js/61.a6c1a4f7.js"><link rel="prefetch" href="/VuePress-blog/assets/js/62.3cc2256f.js"><link rel="prefetch" href="/VuePress-blog/assets/js/63.c33f9fe1.js"><link rel="prefetch" href="/VuePress-blog/assets/js/64.9200eb22.js"><link rel="prefetch" href="/VuePress-blog/assets/js/65.fd000469.js"><link rel="prefetch" href="/VuePress-blog/assets/js/66.512243e8.js"><link rel="prefetch" href="/VuePress-blog/assets/js/67.faaf727b.js"><link rel="prefetch" href="/VuePress-blog/assets/js/68.ef92ba52.js"><link rel="prefetch" href="/VuePress-blog/assets/js/69.b1700696.js"><link rel="prefetch" href="/VuePress-blog/assets/js/7.4e3bdcaf.js"><link rel="prefetch" href="/VuePress-blog/assets/js/70.a0687351.js"><link rel="prefetch" href="/VuePress-blog/assets/js/71.3a14e318.js"><link rel="prefetch" href="/VuePress-blog/assets/js/72.99b53005.js"><link rel="prefetch" href="/VuePress-blog/assets/js/73.897a92b9.js"><link rel="prefetch" href="/VuePress-blog/assets/js/74.b16f1719.js"><link rel="prefetch" href="/VuePress-blog/assets/js/75.002964da.js"><link rel="prefetch" href="/VuePress-blog/assets/js/76.7624e778.js"><link rel="prefetch" href="/VuePress-blog/assets/js/77.e00d405d.js"><link rel="prefetch" href="/VuePress-blog/assets/js/78.95645db5.js"><link rel="prefetch" href="/VuePress-blog/assets/js/79.bba0d631.js"><link rel="prefetch" href="/VuePress-blog/assets/js/8.d7f6aae7.js"><link rel="prefetch" href="/VuePress-blog/assets/js/80.b728c7d7.js"><link rel="prefetch" href="/VuePress-blog/assets/js/81.41b1a44a.js"><link rel="prefetch" href="/VuePress-blog/assets/js/82.c5fe8c82.js"><link rel="prefetch" href="/VuePress-blog/assets/js/83.b899cdd2.js"><link rel="prefetch" href="/VuePress-blog/assets/js/84.f92dd1f0.js"><link rel="prefetch" href="/VuePress-blog/assets/js/85.30ecf40f.js"><link rel="prefetch" href="/VuePress-blog/assets/js/86.62a793c0.js"><link rel="prefetch" href="/VuePress-blog/assets/js/87.97927fa1.js"><link rel="prefetch" href="/VuePress-blog/assets/js/88.f65e94f8.js"><link rel="prefetch" href="/VuePress-blog/assets/js/89.dd682117.js"><link rel="prefetch" href="/VuePress-blog/assets/js/9.2af41852.js"><link rel="prefetch" href="/VuePress-blog/assets/js/90.437e6ec1.js"><link rel="prefetch" href="/VuePress-blog/assets/js/91.577f36e9.js"><link rel="prefetch" href="/VuePress-blog/assets/js/92.7c4d870f.js"><link rel="prefetch" href="/VuePress-blog/assets/js/93.9cfe8160.js"><link rel="prefetch" href="/VuePress-blog/assets/js/94.88b6a333.js"><link rel="prefetch" href="/VuePress-blog/assets/js/95.1ba03060.js"><link rel="prefetch" href="/VuePress-blog/assets/js/96.2693d156.js"><link rel="prefetch" href="/VuePress-blog/assets/js/97.49968a31.js"><link rel="prefetch" href="/VuePress-blog/assets/js/98.71a6785c.js"><link rel="prefetch" href="/VuePress-blog/assets/js/99.b7ba0c42.js">
    <link rel="stylesheet" href="/VuePress-blog/assets/css/0.styles.f7cbc213.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/VuePress-blog/" class="home-link router-link-active"><!----> <span class="site-name">吴起的个人网站</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="文章转载" class="dropdown-title"><span class="title">文章转载</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/VuePress-blog/文章转载/" class="nav-link">
  首页
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/文章转载/Linux常见命令/" class="nav-link">
  Linux常见命令
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/文章转载/Linux常用软件/" class="nav-link">
  Linux常用软件
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/文章转载/docker/" class="nav-link">
  docker
</a></li><li class="dropdown-item"><h4>
          Vim
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/VuePress-blog/文章转载/Vim/vim文章/" class="nav-link">
  vim文章
</a></li><li class="dropdown-subitem"><a href="/VuePress-blog/文章转载/Vim/vim配置/" class="nav-link">
  vim配置
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="常见问题" class="dropdown-title"><span class="title">常见问题</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/VuePress-blog/常见问题/客户端科学上网/" class="nav-link">
  客户端科学上网
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/常见问题/命令行科学上网/" class="nav-link">
  命令行科学上网
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/常见问题/镜像加速大全/" class="nav-link">
  镜像加速大全
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/常见问题/Git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/常见问题/vim/" class="nav-link">
  vim
</a></li><li class="dropdown-item"><h4>
          Pyhton
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/VuePress-blog/常见问题/Python/" class="nav-link">
  Pyhton
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="python" class="dropdown-title"><span class="title">python</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/VuePress-blog/Python/" class="nav-link router-link-active">
  首页
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/Python/最新转载/" class="nav-link">
  最新转载
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/Python/爬虫案例/" class="nav-link">
  爬虫案例
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="个人原创" class="dropdown-title"><span class="title">个人原创</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/VuePress-blog/个人原创/" class="nav-link">
  个人原创
</a></li></ul></div></div> <a href="https://github.com/solider245/VuePress-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    Repo
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="文章转载" class="dropdown-title"><span class="title">文章转载</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/VuePress-blog/文章转载/" class="nav-link">
  首页
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/文章转载/Linux常见命令/" class="nav-link">
  Linux常见命令
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/文章转载/Linux常用软件/" class="nav-link">
  Linux常用软件
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/文章转载/docker/" class="nav-link">
  docker
</a></li><li class="dropdown-item"><h4>
          Vim
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/VuePress-blog/文章转载/Vim/vim文章/" class="nav-link">
  vim文章
</a></li><li class="dropdown-subitem"><a href="/VuePress-blog/文章转载/Vim/vim配置/" class="nav-link">
  vim配置
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="常见问题" class="dropdown-title"><span class="title">常见问题</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/VuePress-blog/常见问题/客户端科学上网/" class="nav-link">
  客户端科学上网
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/常见问题/命令行科学上网/" class="nav-link">
  命令行科学上网
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/常见问题/镜像加速大全/" class="nav-link">
  镜像加速大全
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/常见问题/Git/" class="nav-link">
  Git
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/常见问题/vim/" class="nav-link">
  vim
</a></li><li class="dropdown-item"><h4>
          Pyhton
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/VuePress-blog/常见问题/Python/" class="nav-link">
  Pyhton
</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="python" class="dropdown-title"><span class="title">python</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/VuePress-blog/Python/" class="nav-link router-link-active">
  首页
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/Python/最新转载/" class="nav-link">
  最新转载
</a></li><li class="dropdown-item"><!----> <a href="/VuePress-blog/Python/爬虫案例/" class="nav-link">
  爬虫案例
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="个人原创" class="dropdown-title"><span class="title">个人原创</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/VuePress-blog/个人原创/" class="nav-link">
  个人原创
</a></li></ul></div></div> <a href="https://github.com/solider245/VuePress-blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    Repo
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>最新转载</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/VuePress-blog/Python/最新转载/4行Python代码实时获取股市数据.html" class="sidebar-link">4行Python代码实时获取股市数据</a></li><li><a href="/VuePress-blog/Python/最新转载/Python 爬虫——单线程、多线程、多进程对比.html" class="sidebar-link">Python 爬虫——单线程、多线程、多进程对比</a></li><li><a href="/VuePress-blog/Python/最新转载/Python 爬虫提速：【多进程、多线程、协程+异步】对比测试.html" class="sidebar-link">Python 爬虫提速：【多进程、多线程、协程+异步】对比测试</a></li><li><a href="/VuePress-blog/Python/最新转载/Python 项目管理的利器：虚拟环境 venv 的使用.html" class="sidebar-link">Python 项目管理的利器：虚拟环境 venv 的使用</a></li><li><a href="/VuePress-blog/Python/最新转载/Python使用grequests并发发送请求.html" class="sidebar-link">Python使用grequests并发发送请求</a></li><li><a href="/VuePress-blog/Python/最新转载/Python同步遍历多个列表.html" class="sidebar-link">Python同步遍历多个列表</a></li><li><a href="/VuePress-blog/Python/%E6%9C%80%E6%96%B0%E8%BD%AC%E8%BD%BD/" aria-current="page" class="sidebar-link">README</a></li><li><a href="/VuePress-blog/Python/最新转载/Scrapy 对接 Docker.html" class="sidebar-link">Scrapy 对接 Docker</a></li><li><a href="/VuePress-blog/Python/最新转载/Scrapy分布式爬虫，分布式队列和布隆过滤器，一分钟搞定？ - 掘金.html" class="sidebar-link">Scrapy分布式爬虫，分布式队列和布隆过滤器，一分钟搞定？ - 掘金</a></li><li><a href="/VuePress-blog/Python/最新转载/Scrapy实战3：URL去重策略.html" class="sidebar-link">Scrapy实战3：URL去重策略</a></li><li><a href="/VuePress-blog/Python/最新转载/Web应用程序用Python构建数据科学.html" class="sidebar-link">Web应用程序用Python构建数据科学</a></li><li><a href="/VuePress-blog/Python/最新转载/docker快速搭建分布式爬虫pyspider.html" class="sidebar-link">docker快速搭建分布式爬虫pyspider</a></li><li><a href="/VuePress-blog/Python/最新转载/gevent程序员指南.html" class="sidebar-link">gevent程序员指南</a></li><li><a href="/VuePress-blog/Python/最新转载/main函数的语法模板.html" class="sidebar-link">main函数的语法模板</a></li><li><a href="/VuePress-blog/Python/最新转载/pandas使用的25个技巧.html" class="active sidebar-link">pandas使用的25个技巧</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/VuePress-blog/Python/最新转载/pyenv 和 pyenv-virtualenv 的安装、配置和使用.html" class="sidebar-link">pyenv 和 pyenv-virtualenv 的安装、配置和使用</a></li><li><a href="/VuePress-blog/Python/最新转载/pyenv用国内镜像安装python3.8.html" class="sidebar-link">pyenv用国内镜像安装python3.8</a></li><li><a href="/VuePress-blog/Python/最新转载/pyenv的安装和简单使用(git、pyenv、pyenv-virtualenv).html" class="sidebar-link">pyenv的安装和简单使用（git、pyenv、pyenv-virtualenv）</a></li><li><a href="/VuePress-blog/Python/最新转载/python time获取两个时间点的差.html" class="sidebar-link">python time获取两个时间点的差</a></li><li><a href="/VuePress-blog/Python/最新转载/python常见可视化工具库.html" class="sidebar-link">python常见可视化工具库</a></li><li><a href="/VuePress-blog/Python/最新转载/python爬虫入门-05-URL去重.html" class="sidebar-link">python爬虫入门-05-URL去重</a></li><li><a href="/VuePress-blog/Python/最新转载/python笔记49：两种方式来遍历目录.html" class="sidebar-link">python笔记49：两种方式来遍历目录</a></li><li><a href="/VuePress-blog/Python/最新转载/scrapy docker教程.html" class="sidebar-link">scrapy docker教程</a></li><li><a href="/VuePress-blog/Python/最新转载/一文看懂Python多进程与多线程编程(工作学习面试必读).html" class="sidebar-link">一文看懂Python多进程与多线程编程(工作学习面试必读)</a></li><li><a href="/VuePress-blog/Python/最新转载/一篇文章搞定Python多进程(全).html" class="sidebar-link">一篇文章搞定Python多进程(全)</a></li><li><a href="/VuePress-blog/Python/最新转载/为Python选择一个更快的JSON库.html" class="sidebar-link">为Python选择一个更快的JSON库</a></li><li><a href="/VuePress-blog/Python/最新转载/为什么您的多处理池卡住了（它充满了鲨鱼！）.html" class="sidebar-link">为什么您的多处理池卡住了（它充满了鲨鱼！）</a></li><li><a href="/VuePress-blog/Python/最新转载/使用Docker分布式部署爬虫系统Pyspider.html" class="sidebar-link">使用Docker分布式部署爬虫系统Pyspider</a></li><li><a href="/VuePress-blog/Python/最新转载/使用Python和Vue.js自动化报告过程.html" class="sidebar-link">使用Python和Vue.js自动化报告过程</a></li><li><a href="/VuePress-blog/Python/最新转载/停止用CSV格式保存Pandas数据帧.html" class="sidebar-link">停止用CSV格式保存Pandas数据帧</a></li><li><a href="/VuePress-blog/Python/最新转载/函数式编程-酷壳网.html" class="sidebar-link">函数式编程-酷壳网</a></li><li><a href="/VuePress-blog/Python/最新转载/函数式编程的实用介绍.html" class="sidebar-link">函数式编程的实用介绍</a></li><li><a href="/VuePress-blog/Python/最新转载/四十四、Python的os模块的文件与目录常用方法.html" class="sidebar-link">Python的os模块的文件与目录常用方法</a></li><li><a href="/VuePress-blog/Python/最新转载/在Python中main函数是怎么来的.html" class="sidebar-link">在Python中main函数是怎么来的</a></li><li><a href="/VuePress-blog/Python/最新转载/在Python中妥善使用进度条.html" class="sidebar-link">在Python中妥善使用进度条</a></li><li><a href="/VuePress-blog/Python/最新转载/外行学Python爬虫第四篇URL去重.html" class="sidebar-link">外行学Python爬虫第四篇URL去重</a></li><li><a href="/VuePress-blog/Python/最新转载/多线程threading.html" class="sidebar-link">多线程threading</a></li><li><a href="/VuePress-blog/Python/最新转载/多线程、进程太慢？嫌Scrapy太麻烦？没事，异步高调走起.html" class="sidebar-link">进程)太慢？嫌Scrapy太麻烦？没事，异步高调走起</a></li><li><a href="/VuePress-blog/Python/最新转载/如何在Python中实现树？.html" class="sidebar-link">如何在Python中实现树？</a></li><li><a href="/VuePress-blog/Python/最新转载/带有动手示例的Python-main功能教程.html" class="sidebar-link">带有动手示例的Python-main功能教程</a></li><li><a href="/VuePress-blog/Python/最新转载/日期时间-日期-时间值操作.html" class="sidebar-link">日期时间-日期-时间值操作</a></li><li><a href="/VuePress-blog/Python/最新转载/时间函数datetime常见用法汇总.html" class="sidebar-link">时间函数datetime常见用法汇总</a></li><li><a href="/VuePress-blog/Python/最新转载/最全的Python虚拟环境使用方法.html" class="sidebar-link">最全的Python虚拟环境使用方法</a></li><li><a href="/VuePress-blog/Python/最新转载/爬虫常用Xpath和CSS3选择器对比.html" class="sidebar-link">爬虫常用Xpath和CSS3选择器对比</a></li><li><a href="/VuePress-blog/Python/最新转载/爬虫练习之数据清洗——基于Pandas.html" class="sidebar-link">爬虫练习之数据清洗——基于Pandas</a></li><li><a href="/VuePress-blog/Python/最新转载/芝加哥哈林顿教授Python教程.html" class="sidebar-link">芝加哥哈林顿教授Python教程</a></li><li><a href="/VuePress-blog/Python/最新转载/虚拟环境和包官方.html" class="sidebar-link">虚拟环境和包</a></li><li><a href="/VuePress-blog/Python/最新转载/谈谈python的GIL、多线程、多进程.html" class="sidebar-link">谈谈python的GIL、多线程、多进程</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><p></p><div class="table-of-contents"><ul><li><a href="#_1-显示已安装的版本">1\. 显示已安装的版本</a></li><li><a href="#_2-创建示例dataframe">2\. 创建示例DataFrame</a></li><li><a href="#_3-更改列名">3\. 更改列名</a></li><li><a href="#_4-行序反转">4\. 行序反转</a></li><li><a href="#_5-列序反转">5\. 列序反转</a></li><li><a href="#_6-通过数据类型选择列">6\. 通过数据类型选择列</a></li><li><a href="#_7-将字符型转换为数值型">7\. 将字符型转换为数值型</a></li><li><a href="#_8-减小dataframe空间大小">8\. 减小DataFrame空间大小</a></li><li><a href="#_9-按行从多个文件中构建dataframe">9\. 按行从多个文件中构建DataFrame</a></li><li><a href="#_10-按列从多个文件中构建dataframe">10\. 按列从多个文件中构建DataFrame</a></li><li><a href="#_11-从剪贴板中创建dataframe">11\. 从剪贴板中创建DataFrame</a></li><li><a href="#_12-将dataframe划分为两个随机的子集">12\. 将DataFrame划分为两个随机的子集</a></li><li><a href="#_13-通过多种类型对dataframe进行过滤">13\. 通过多种类型对DataFrame进行过滤</a></li><li><a href="#_14-从dataframe中筛选出数量最多的类别">14\. 从DataFrame中筛选出数量最多的类别</a></li><li><a href="#_15-处理缺失值">15\. 处理缺失值</a></li><li><a href="#_16-将一个字符串划分成多个列">16\. 将一个字符串划分成多个列</a></li><li><a href="#_17-将一个由列表组成的series扩展成dataframe">17\. 将一个由列表组成的Series扩展成DataFrame</a></li><li><a href="#_18-对多个函数进行聚合">18\. 对多个函数进行聚合</a></li><li><a href="#_19-将聚合结果与dataframe进行组合">19\. 将聚合结果与DataFrame进行组合</a></li><li><a href="#_20-选取行和列的切片">20\. 选取行和列的切片</a></li><li><a href="#_21-对multiindexed-series进行重塑">21\. 对MultiIndexed Series进行重塑</a></li><li><a href="#_22-创建数据透视表（pivot-table）">22\. 创建数据透视表（pivot table）</a></li><li><a href="#_23-将连续数据转变成类别数据">23\. 将连续数据转变成类别数据</a></li><li><a href="#_24-更改显示选项">24\. 更改显示选项</a></li><li><a href="#_25-style-a-dataframe">25\. Style a DataFrame</a></li><li><a href="#额外技巧：profile-a-dataframe">额外技巧：Profile a DataFrame</a></li></ul></div>
  本文翻译自<a href="https://nbviewer.jupyter.org/github/justmarkham/pandas-videos/blob/master/top_25_pandas_tricks.ipynb" target="_blank" rel="noopener noreferrer">https://nbviewer.jupyter.org/github/justmarkham/pandas-videos/blob/master/top_25_pandas_tricks.ipynb<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> ，翻译如有不当之处，还请批评指正。<br>
  首先我们需要先提前下载好<code>示例数据集</code>：<p></p> <ul><li>drinksbycountry.csv : <a href="http://bit.ly/drinksbycountry" target="_blank" rel="noopener noreferrer">http://bit.ly/drinksbycountry<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>imdbratings.csv : <a href="http://bit.ly/imdbratings" target="_blank" rel="noopener noreferrer">http://bit.ly/imdbratings<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>chiporders.csv : <a href="http://bit.ly/chiporders" target="_blank" rel="noopener noreferrer">http://bit.ly/chiporders<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>smallstockers.csv : <a href="http://bit.ly/smallstocks" target="_blank" rel="noopener noreferrer">http://bit.ly/smallstocks<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>kaggletrain.csv : <a href="http://bit.ly/kaggletrain" target="_blank" rel="noopener noreferrer">http://bit.ly/kaggletrain<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>uforeports.csv : <a href="http://bit.ly/uforeports" target="_blank" rel="noopener noreferrer">http://bit.ly/uforeports<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <p>利用以下代码导入上述数据集：<br> <img src="https://img-blog.csdnimg.cn/20200213134318260.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <h3 id="_1-显示已安装的版本">1. 显示已安装的版本</h3> <p>输入下面的命令查询pandas版本：<br> <img src="https://img-blog.csdnimg.cn/20200213134634597.png" alt=""></p> <p>如果你还想知道pandas所依赖的模块的版本，你可以使用<code>show_versions()</code>函数:<br> <img src="https://img-blog.csdnimg.cn/20200213135024144.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>你可以查看到Python，pandas, Numpy, matplotlib等的版本信息。</p> <h3 id="_2-创建示例dataframe">2. 创建示例DataFrame</h3> <p>假设你需要创建一个示例DataFrame。有很多种实现的途径，我最喜欢的方式是传一个字典给DataFrame constructor，其中字典中的keys为列名，values为列的取值。<br> <img src="https://img-blog.csdnimg.cn/20200213135535467.png" alt=""></p> <p>现在如果你需要创建一个更大的DataFrame，上述方法则需要太多的输入。在这种情况下，你可以使用Numpy的<code>random.rand()</code>函数，告诉它行数和列数，将它传递给DataFrame constructor：<br> <img src="https://img-blog.csdnimg.cn/20200213135827591.png" alt=""></p> <p>这种方式很好，但如果你还想把列名变为非数值型的，你可以强制地将一串字符赋值给<code>columns</code>参数：<br> <img src="https://img-blog.csdnimg.cn/20200213140111112.png" alt=""></p> <p>你可以想到，你传递的字符串的长度必须与列数相同。</p> <h3 id="_3-更改列名">3. 更改列名</h3> <p>让我们来看一下刚才我们创建的示例DataFrame:<br> <img src="https://img-blog.csdnimg.cn/2020021314042780.png" alt=""></p> <p>我更喜欢在选取pandas列的时候使用点（.），但是这对那么列名中含有空格的列不会生效。让我们来修复这个问题。<br>
  更改列名最灵活的方式是使用<code>rename()</code>函数。你可以传递一个字典，其中keys为原列名，values为新列名，还可以指定axis:<br> <img src="https://img-blog.csdnimg.cn/20200213140957225.png" alt=""></p> <p>使用这个函数最好的方式是你需要更改任意数量的列名，不管是一列或者全部的列。<br>
  如果你需要一次性重新命令所有的列名，更简单的方式就是重写DataFrame的<code>columns</code>属性：<br> <img src="https://img-blog.csdnimg.cn/20200213141400424.png" alt=""></p> <p>如果你需要做的仅仅是将空格换成下划线，那么更好的办法是使用<code>str.replace()</code>方法，这是因为你都不需要输入所有的列名：<br> <img src="https://img-blog.csdnimg.cn/20200213141539738.png" alt=""></p> <p>上述三个函数的结果都一样，可以更改列名使得列名中不含有空格：<br> <img src="https://img-blog.csdnimg.cn/20200213141656923.png" alt=""></p> <p>最后，如果你需要在列名中添加前缀或者后缀，你可以使用<code>add_prefix()</code>函数：<br> <img src="https://img-blog.csdnimg.cn/20200213141900409.png" alt=""></p> <p>或者使用<code>add_suffix()</code>函数：<br> <img src="https://img-blog.csdnimg.cn/2020021314194755.png" alt=""></p> <h3 id="_4-行序反转">4. 行序反转</h3> <p>让我们来看一下drinks这个DataFame:<br> <img src="https://img-blog.csdnimg.cn/20200213142105193.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>该数据集描述了每个国家的平均酒消费量。如果你想要将行序反转呢？<br>
  最直接的办法是使用<code>loc</code>函数并传递<code>::-1</code>，跟Python中列表反转时使用的切片符号一致：<br> <img src="https://img-blog.csdnimg.cn/20200213142516214.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>如果你还想重置索引使得它从0开始呢？<br>
  你可以使用<code>reset_index()</code>函数，告诉他去掉完全抛弃之前的索引：<br> <img src="https://img-blog.csdnimg.cn/20200213142745547.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>你可以看到，行序已经反转，索引也被重置为默认的整数序号。</p> <h3 id="_5-列序反转">5. 列序反转</h3> <p>跟之前的技巧一样，你也可以使用<code>loc</code>函数将列从左至右反转：<br> <img src="https://img-blog.csdnimg.cn/20200213143033484.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>逗号之前的冒号表示选择所有行，逗号之后的<code>::-1</code>表示反转所有的列，这就是为什么country这一列现在在最右边。</p> <h3 id="_6-通过数据类型选择列">6. 通过数据类型选择列</h3> <p>这里有drinks这个DataFrame的数据类型：<br> <img src="https://img-blog.csdnimg.cn/20200213143355688.png" alt=""></p> <p>假设你仅仅需要选取数值型的列，那么你可以使用<code>select_dtypes()</code>函数：<br> <img src="https://img-blog.csdnimg.cn/20200213143550129.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>这包含了int和float型的列。<br>
  你也可以使用这个函数来选取数据类型为object的列：<br> <img src="https://img-blog.csdnimg.cn/20200213143757578.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>你还可以选取多种数据类型，只需要传递一个列表即可：<br> <img src="https://img-blog.csdnimg.cn/20200213143948493.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>你还可以用来排除特定的数据类型：<br> <img src="https://img-blog.csdnimg.cn/20200213144108973.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <h3 id="_7-将字符型转换为数值型">7. 将字符型转换为数值型</h3> <p>让我们来创建另一个示例DataFrame:<br> <img src="https://img-blog.csdnimg.cn/20200213144239264.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>这些数字实际上储存为字符型，导致其数据类型为object:<br> <img src="https://img-blog.csdnimg.cn/20200213144358671.png" alt=""></p> <p>为了对这些列进行数学运算，我们需要将数据类型转换成数值型。你可以对前两列使用<code>astype()</code>函数：<br> <img src="https://img-blog.csdnimg.cn/2020021314454095.png" alt=""></p> <p>但是，如果你对第三列也使用这个函数，将会引起错误，这是因为这一列包含了破折号（用来表示0）但是pandas并不知道如何处理它。<br>
  你可以对第三列使用<code>to_numeric()</code>函数，告诉其将任何无效数据转换为<code>NaN</code>:<br> <img src="https://img-blog.csdnimg.cn/20200213144953141.png" alt=""></p> <p>如果你知道<code>NaN</code>值代表0，那么你可以<code>fillna()</code>函数将他们替换成0：<br> <img src="https://img-blog.csdnimg.cn/20200213145410815.png" alt=""></p> <p>最后，你可以通过<code>apply()</code>函数一次性对整个DataFrame使用这个函数：<br> <img src="https://img-blog.csdnimg.cn/20200213145629990.png" alt=""></p> <p>仅需一行代码就完成了我们的目标，因为现在所有的数据类型都转换成float:<br> <img src="https://img-blog.csdnimg.cn/20200213145803706.png" alt=""></p> <h3 id="_8-减小dataframe空间大小">8. 减小DataFrame空间大小</h3> <p>pandas DataFrame被设计成可以适应内存，所以有些时候你可以减小DataFrame的空间大小，让它在你的系统上更好地运行起来。<br>
  这是drinks这个DataFrame所占用的空间大小：<br> <img src="https://img-blog.csdnimg.cn/20200213150150551.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>可以看到它使用了304.KB。<br>
  如果你对你的DataFrame有操作方面的问题，或者你不能将它读进内存，那么在读取文件的过程中有两个步骤可以使用来减小DataFrame的空间大小。<br>
  第一个步骤是只读取那些你实际上需要用到的列，可以调用<code>usecols</code>参数：<br> <img src="https://img-blog.csdnimg.cn/20200213153724215.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>通过仅读取用到的两列，我们将DataFrame的空间大小缩小至13.6KB。<br>
  第二步是将所有实际上为类别变量的object列转换成类别变量，可以调用<code>dtypes</code>参数：<br> <img src="https://img-blog.csdnimg.cn/20200213154322101.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>通过将continent列读取为category数据类型，我们进一步地把DataFrame的空间大小缩小至2.3KB。<br>
  值得注意的是，如果跟行数相比，category数据类型的列数相对较小，那么catefory数据类型可以减小内存占用。</p> <h3 id="_9-按行从多个文件中构建dataframe">9. 按行从多个文件中构建DataFrame</h3> <p>假设你的数据集分化为多个文件，但是你需要将这些数据集读到一个DataFrame中。<br>
  举例来说，我有一些关于股票的小数聚集，每个数据集为单天的CSV文件。这是第一天的：<br> <img src="https://img-blog.csdnimg.cn/20200213155939459.png" alt=""></p> <p>这是第二天的：<br> <img src="https://img-blog.csdnimg.cn/20200213160027948.png" alt=""></p> <p>这是第三天的：<br> <img src="https://img-blog.csdnimg.cn/20200213160117917.png" alt=""></p> <p>你可以将每个CSV文件读取成DataFrame，将它们结合起来，然后再删除原来的DataFrame，但是这样会多占用内存且需要许多代码。<br>
  更好的方式为使用内置的<code>glob</code>模块。你可以给<code>glob()</code>函数传递某种模式，包括未知字符，这样它会返回符合该某事的文件列表。在这种方式下，glob会查找所有以stocks开头的CSV文件：<br> <img src="https://img-blog.csdnimg.cn/20200213161526639.png" alt=""></p> <p>glob会返回任意排序的文件名，这就是我们为什么要用Python内置的<code>sorted()</code>函数来对列表进行排序。<br>
  我们以生成器表达式用<code>read_csv()</code>函数来读取每个文件，并将结果传递给<code>concat()</code>函数，这会将单个的DataFrame按行来组合：<br> <img src="https://img-blog.csdnimg.cn/20200213162018131.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>不幸的是，索引值存在重复。为了避免这种情况，我们需要告诉<code>concat()</code>函数来忽略索引，使用默认的整数索引：<br> <img src="https://img-blog.csdnimg.cn/20200213162231616.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <h3 id="_10-按列从多个文件中构建dataframe">10. 按列从多个文件中构建DataFrame</h3> <p>上一个技巧对于数据集中每个文件包含行记录很有用。但是如果数据集中的每个文件包含的列信息呢？<br>
  这里有一个例子，dinks数据集被划分成两个CSV文件，每个文件包含三列：<br> <img src="https://img-blog.csdnimg.cn/20200213163008601.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>同上一个技巧一样，我们以使用<code>glob()</code>函数开始。这一次，我们需要告诉<code>concat()</code>函数按列来组合：<br> <img src="https://img-blog.csdnimg.cn/20200213163203843.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>现在我们的DataFrame已经有六列了。</p> <h3 id="_11-从剪贴板中创建dataframe">11. 从剪贴板中创建DataFrame</h3> <p>假设你将一些数据储存在Excel或者Google Sheet中，你又想要尽快地将他们读取至DataFrame中。<br>
  你需要选择这些数据并复制至剪贴板。然后，你可以使用<code>read_clipboard()</code>函数将他们读取至DataFrame中：<br> <img src="https://img-blog.csdnimg.cn/20200213163845516.png" alt=""></p> <p>和<code>read_csv()</code>类似，<code>read_clipboard()</code>会自动检测每一列的正确的数据类型：<br> <img src="https://img-blog.csdnimg.cn/20200213164109657.png" alt=""></p> <p>让我们再复制另外一个数据至剪贴板：<br> <img src="https://img-blog.csdnimg.cn/20200213164356696.png" alt=""></p> <p>神奇的是，pandas已经将第一列作为索引了：<br> <img src="https://img-blog.csdnimg.cn/20200213164434515.png" alt=""></p> <p>需要注意的是，如果你想要你的工作在未来可复制，那么<code>read_clipboard()</code>并不值得推荐。</p> <h3 id="_12-将dataframe划分为两个随机的子集">12. 将DataFrame划分为两个随机的子集</h3> <p>假设你想要将一个DataFrame划分为两部分，随机地将75%的行给一个DataFrame，剩下的25%的行给另一个DataFrame。<br>
  举例来说，我们的movie ratings这个DataFrame有979行：<br> <img src="https://img-blog.csdnimg.cn/20200213164829233.png" alt=""></p> <p>我们可以使用<code>sample()</code>函数来随机选取75%的行，并将它们赋值给&quot;movies_1&quot;DataFrame：<br> <img src="https://img-blog.csdnimg.cn/20200213164959460.png" alt=""></p> <p>接着我们使用<code>drop()</code>函数来舍弃“moive_1”中出现过的行，将剩下的行赋值给&quot;movies_2&quot;DataFrame：<br> <img src="https://img-blog.csdnimg.cn/20200213165141571.png" alt=""></p> <p>你可以发现总的行数是正确的：<br> <img src="https://img-blog.csdnimg.cn/20200213165349836.png" alt=""></p> <p>你还可以检查每部电影的索引，或者&quot;moives_1&quot;:<br> <img src="https://img-blog.csdnimg.cn/20200213165534746.png" alt=""></p> <p>或者&quot;moives_2&quot;:<br> <img src="https://img-blog.csdnimg.cn/20200213165614973.png" alt=""></p> <p>需要注意的是，这个方法在索引值不唯一的情况下不起作用。<br> <code>读者注</code>：该方法在机器学习或者深度学习中很有用，因为在模型训练前，我们往往需要将全部数据集按某个比例划分成训练集和测试集。该方法既简单又高效，值得学习和尝试。</p> <h3 id="_13-通过多种类型对dataframe进行过滤">13. 通过多种类型对DataFrame进行过滤</h3> <p>让我们先看一眼movies这个DataFrame：<br> <img src="https://img-blog.csdnimg.cn/20200213170025753.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>其中有一列是genre（类型）:<br> <img src="https://img-blog.csdnimg.cn/20200213170112295.png" alt=""></p> <p>比如我们想要对该DataFrame进行过滤，我们只想显示genre为Action或者Drama或者Western的电影，我们可以使用多个条件，以&quot;or&quot;符号分隔：<br> <img src="https://img-blog.csdnimg.cn/20200213170340422.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>但是，你实际上可以使用<code>isin()</code>函数将代码写得更加清晰，将genres列表传递给该函数：<br> <img src="https://img-blog.csdnimg.cn/20200213170528630.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>如果你想要进行相反的过滤，也就是你将吧刚才的三种类型的电影排除掉，那么你可以在过滤条件前加上破浪号：<br> <img src="https://img-blog.csdnimg.cn/20200213170738125.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>这种方法能够起作用是因为在Python中，波浪号表示“not”操作。</p> <h3 id="_14-从dataframe中筛选出数量最多的类别">14. 从DataFrame中筛选出数量最多的类别</h3> <p>假设你想要对movies这个DataFrame通过genre进行过滤，但是只需要前3个数量最多的genre。<br>
  我们对genre使用<code>value_counts()</code>函数，并将它保存成counts（type为Series）:<br> <img src="https://img-blog.csdnimg.cn/20200213171150347.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>&amp;emp; 该Series的<code>nlargest()</code>函数能够轻松地计算出Series中前3个最大值：<br> <img src="https://img-blog.csdnimg.cn/20200213171311418.png" alt=""></p> <p>事实上我们在该Series中需要的是索引：<br> <img src="https://img-blog.csdnimg.cn/2020021317142949.png" alt=""></p> <p>最后，我们将该索引传递给<code>isin()</code>函数，该函数会把它当成genre列表：<br> <img src="https://img-blog.csdnimg.cn/20200213171558651.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>这样，在DataFrame中只剩下Drame, Comdey, Action这三种类型的电影了。</p> <h3 id="_15-处理缺失值">15. 处理缺失值</h3> <p>让我们来看一看UFO sightings这个DataFrame:<br> <img src="https://img-blog.csdnimg.cn/20200213171759183.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>你将会注意到有些值是缺失的。<br>
  为了找出每一列中有多少值是缺失的，你可以使用<code>isna()</code>函数，然后再使用<code>sum()</code>:<br> <img src="https://img-blog.csdnimg.cn/20200213190335647.png" alt=""></p> <p><code>isna()</code>会产生一个由True和False组成的DataFrame，<code>sum()</code>会将所有的True值转换为1，False转换为0并把它们加起来。<br>
  类似地，你可以通过<code>mean()</code>和<code>isna()</code>函数找出每一列中缺失值的百分比。<br> <img src="https://img-blog.csdnimg.cn/20200213190717669.png" alt=""></p> <p>如果你想要舍弃那些包含了缺失值的列，你可以使用<code>dropna()</code>函数：<br> <img src="https://img-blog.csdnimg.cn/20200213190905444.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>或者你想要舍弃那么缺失值占比超过10%的列，你可以给<code>dropna()</code>设置一个阈值：<br> <img src="https://img-blog.csdnimg.cn/20200213191103243.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p><code>len(ufo)</code>返回总行数，我们将它乘以0.9，以告诉pandas保留那些至少90%的值不是缺失值的列。</p> <h3 id="_16-将一个字符串划分成多个列">16. 将一个字符串划分成多个列</h3> <p>我们先创建另一个新的示例DataFrame:<br> <img src="https://img-blog.csdnimg.cn/20200213191356736.png" alt=""></p> <p>如果我们需要将“name”这一列划分为三个独立的列，用来表示first, middle, last name呢？我们将会使用<code>str.split()</code>函数，告诉它以空格进行分隔，并将结果扩展成一个DataFrame:<br> <img src="https://img-blog.csdnimg.cn/20200213191701424.png" alt=""></p> <p>这三列实际上可以通过一行代码保存至原来的DataFrame:<br> <img src="https://img-blog.csdnimg.cn/20200213191832276.png" alt=""></p> <p>如果我们想要划分一个字符串，但是仅保留其中一个结果列呢？比如说，让我们以&quot;, &quot;来划分location这一列：<br> <img src="https://img-blog.csdnimg.cn/20200213192227238.png" alt=""></p> <p>如果我们只想保留第0列作为city name，我们仅需要选择那一列并保存至DataFrame:<br> <img src="https://img-blog.csdnimg.cn/20200213192359717.png" alt=""></p> <h3 id="_17-将一个由列表组成的series扩展成dataframe">17. 将一个由列表组成的Series扩展成DataFrame</h3> <p>让我们创建一个新的示例DataFrame:<br> <img src="https://img-blog.csdnimg.cn/20200213192524683.png" alt=""></p> <p>这里有两列，第二列包含了Python中的由整数元素组成的列表。<br>
  如果我们想要将第二列扩展成DataFrame，我们可以对那一列使用<code>apply()</code>函数并传递给Series constructor:<br> <img src="https://img-blog.csdnimg.cn/20200213192804322.png" alt=""></p> <p>通过使用<code>concat()</code>函数，我们可以将原来的DataFrame和新的DataFrame组合起来：<br> <img src="https://img-blog.csdnimg.cn/20200213192914699.png" alt=""></p> <h3 id="_18-对多个函数进行聚合">18. 对多个函数进行聚合</h3> <p>让我们来看一眼从Chipotle restaurant chain得到的orders这个DataFrame:<br> <img src="https://img-blog.csdnimg.cn/20200213193105704.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>每个订单（order）都有订单号（order_id），包含一行或者多行。为了找出每个订单的总价格，你可以将那个订单号的价格（item_price）加起来。比如，这里是订单号为1的总价格：<br> <img src="https://img-blog.csdnimg.cn/20200213193422825.png" alt=""></p> <p>如果你想要计算每个订单的总价格，你可以对order_id使用<code>groupby()</code>，再对每个group的item_price进行求和。<br> <img src="https://img-blog.csdnimg.cn/20200213193634347.png" alt=""></p> <p>但是，事实上你不可能在聚合时仅使用一个函数，比如<code>sum()</code>。为了对多个函数进行聚合，你可以使用<code>agg()</code>函数，传给它一个函数列表，比如<code>sum()</code>和<code>count()</code>:<br> <img src="https://img-blog.csdnimg.cn/20200213193940691.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>这将告诉我们没定订单的总价格和数量。</p> <h3 id="_19-将聚合结果与dataframe进行组合">19. 将聚合结果与DataFrame进行组合</h3> <p>让我们再看一眼orders这个DataFrame:<br> <img src="https://img-blog.csdnimg.cn/20200213194152224.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>如果我们想要增加新的一列，用于展示每个订单的总价格呢？回忆一下，我们通过使用<code>sum()</code>函数得到了总价格：<br> <img src="https://img-blog.csdnimg.cn/20200213194330485.png" alt=""></p> <p><code>sum()</code>是一个聚合函数，这表明它返回输入数据的精简版本（reduced version ）。<br>
  换句话说，<code>sum()</code>函数的输出：<br> <img src="https://img-blog.csdnimg.cn/20200213194645422.png" alt=""></p> <p>比这个函数的输入要小：<br> <img src="https://img-blog.csdnimg.cn/20200213194722624.png" alt=""></p> <p>解决的办法是使用<code>transform()</code>函数，它会执行相同的操作但是返回与输入数据相同的形状：<br> <img src="https://img-blog.csdnimg.cn/20200213194857197.png" alt=""></p> <p>我们将这个结果存储至DataFrame中新的一列：<br> <img src="https://img-blog.csdnimg.cn/20200213195031864.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>你可以看到，每个订单的总价格在每一行中显示出来了。<br>
  这样我们就能方便地甲酸每个订单的价格占该订单的总价格的百分比：<br> <img src="https://img-blog.csdnimg.cn/20200213195245805.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <h3 id="_20-选取行和列的切片">20. 选取行和列的切片</h3> <p>让我们看一眼另一个数据集：<br> <img src="https://img-blog.csdnimg.cn/20200213195359445.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>这就是著名的Titanic数据集，它保存了Titanic上乘客的信息以及他们是否存活。<br>
  如果你想要对这个数据集做一个数值方面的总结，你可以使用<code>describe()</code>函数：<br> <img src="https://img-blog.csdnimg.cn/20200213195609161.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>但是，这个DataFrame结果可能比你想要的信息显示得更多。<br>
  如果你想对这个结果进行过滤，只想显示“五数概括法”（five-number summary）的信息，你可以使用<code>loc</code>函数并传递&quot;min&quot;到&quot;max&quot;的切片:<br> <img src="https://img-blog.csdnimg.cn/20200213195944935.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>如果你不是对所有列都感兴趣，你也可以传递列名的切片：<br> <img src="https://img-blog.csdnimg.cn/20200213200212900.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <h3 id="_21-对multiindexed-series进行重塑">21. 对MultiIndexed Series进行重塑</h3> <p>Titanic数据集的Survived列由1和0组成，因此你可以对这一列计算总的存活率：<br> <img src="https://img-blog.csdnimg.cn/20200213200630561.png" alt=""></p> <p>如果你想对某个类别，比如“Sex”，计算存活率，你可以使用<code>groupby()</code>:<br> <img src="https://img-blog.csdnimg.cn/20200213200758524.png" alt=""></p> <p>如果你想一次性对两个类别变量计算存活率，你可以对这些类别变量使用<code>groupby()</code>：<br> <img src="https://img-blog.csdnimg.cn/20200213200942509.png" alt=""></p> <p>该结果展示了由Sex和Passenger Class联合起来的存活率。它存储为一个MultiIndexed Series，也就是说它对实际数据有多个索引层级。<br>
  这使得该数据难以读取和交互，因此更为方便的是通过<code>unstack()</code>函数将MultiIndexed Series重塑成一个DataFrame:<br> <img src="https://img-blog.csdnimg.cn/20200213201502445.png" alt=""></p> <p>该DataFrame包含了与MultiIndexed Series一样的数据，不同的是，现在你可以用熟悉的DataFrame的函数对它进行操作。</p> <h3 id="_22-创建数据透视表（pivot-table）">22. 创建数据透视表（pivot table）</h3> <p>如果你经常使用上述的方法创建DataFrames，你也许会发现用<code>pivot_table()</code>函数更为便捷：<br> <img src="https://img-blog.csdnimg.cn/20200213201934697.png" alt=""></p> <p>想要使用数据透视表，你需要指定索引(index), 列名(columns), 值(values)和聚合函数(aggregation function)。<br>
  数据透视表的另一个好处是，你可以通过设置<code>margins=True</code>轻松地将行和列都加起来：<br> <img src="https://img-blog.csdnimg.cn/20200213202307186.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>这个结果既显示了总的存活率，也显示了Sex和Passenger Class的存活率。<br>
  最后，你可以创建交叉表（cross-tabulation），只需要将聚合函数由&quot;mean&quot;改为&quot;count&quot;:<br> <img src="https://img-blog.csdnimg.cn/20200213202611593.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>这个结果展示了每一对类别变量组合后的记录总数。</p> <h3 id="_23-将连续数据转变成类别数据">23. 将连续数据转变成类别数据</h3> <p>让我们来看一下Titanic数据集中的Age那一列：<br> <img src="https://img-blog.csdnimg.cn/20200213202841534.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>它现在是连续性数据，但是如果我们想要将它转变成类别数据呢？<br>
  一个解决办法是对年龄范围打标签，比如&quot;adult&quot;, &quot;young adult&quot;, &quot;child&quot;。实现该功能的最好方式是使用<code>cut()</code>函数：<br> <img src="https://img-blog.csdnimg.cn/20200213203112761.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>这会对每个值打上标签。0到18岁的打上标签&quot;child&quot;，18-25岁的打上标签&quot;young adult&quot;，25到99岁的打上标签“adult”。<br>
  注意到，该数据类型为类别变量，该类别变量自动排好序了（有序的类别变量）。</p> <h3 id="_24-更改显示选项">24. 更改显示选项</h3> <p>让我们再来看一眼Titanic 数据集：<br> <img src="https://img-blog.csdnimg.cn/202002132035450.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>注意到，Age列保留到小数点后1位，Fare列保留到小数点后4位。如果你想要标准化，将显示结果保留到小数点后2位呢？<br>
  你可以使用<code>set_option()</code>函数：<br> <img src="https://img-blog.csdnimg.cn/20200213203824821.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p><code>set_option()</code>函数中第一个参数为选项的名称，第二个参数为Python格式化字符。可以看到，Age列和Fare列现在已经保留小数点后两位。注意，这并没有修改基础的数据类型，而只是修改了数据的显示结果。<br>
  你也可以重置任何一个选项为其默认值：<br> <img src="https://img-blog.csdnimg.cn/20200213204132126.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>对于其它的选项也是类似的使用方法。</p> <h3 id="_25-style-a-dataframe">25. Style a DataFrame</h3> <p>上一个技巧在你想要修改整个jupyter notebook中的显示会很有用。但是，一个更灵活和有用的方法是定义特定DataFrame中的格式化（style）。<br>
  让我们回到stocks这个DataFrame:<br> <img src="https://img-blog.csdnimg.cn/2020021320460777.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>我们可以创建一个格式化字符串的字典，用于对每一列进行格式化。然后将其传递给DataFrame的<code>style.format()</code>函数：<br> <img src="https://img-blog.csdnimg.cn/20200213204848365.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>注意到，Date列是month-day-year的格式，Close列包含一个$符号，Volume列包含逗号。<br>
  我们可以通过链式调用函数来应用更多的格式化：<br> <img src="https://img-blog.csdnimg.cn/20200213205203287.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>我们现在隐藏了索引，将Close列中的最小值高亮成红色，将Close列中的最大值高亮成浅绿色。<br>
  这里有另一个DataFrame格式化的例子：<br> <img src="https://img-blog.csdnimg.cn/2020021320544593.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>Volume列现在有一个渐变的背景色，你可以轻松地识别出大的和小的数值。<br>
  最后一个例子：<br> <img src="https://img-blog.csdnimg.cn/20200213205640582.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>现在，Volumn列上有一个条形图，DataFrame上有一个标题。<br>
  请注意，还有许多其他的选项你可以用来格式化DataFrame。</p> <h3 id="额外技巧：profile-a-dataframe">额外技巧：Profile a DataFrame</h3> <p>假设你拿到一个新的数据集，你不想要花费太多力气，只是想快速地探索下。那么你可以使用<code>pandas-profiling</code>这个模块。<br>
  在你的系统上安装好该模块，然后使用<code>ProfileReport()</code>函数，传递的参数为任何一个DataFrame。它会返回一个互动的HTML报告：</p> <ul><li>第一部分为该数据集的总览，以及该数据集可能出现的问题列表；</li> <li>第二部分为每一列的总结。你可以点击&quot;toggle details&quot;获取更多信息；</li> <li>第三部分显示列之间的关联热力图；</li> <li>第四部分为缺失值情况报告；</li> <li>第五部分显示该数据及的前几行。</li></ul> <p>使用示例如下（只显示第一部分的报告）：</p> <p><img src="https://img-blog.csdnimg.cn/20200213213309144.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2pjbGlhbjkx,size_16,color_FFFFFF,t_70" alt=""></p> <p>这部分的代码已经放在Github上，网址为：<a href="https://github.com/percent4/panas_usage_25_tricks" target="_blank" rel="noopener noreferrer">https://github.com/percent4/panas_usage_25_tricks<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 。<br>
  感谢大家的阅读~</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/solider245/VuePress-blog/edit/master/docs/Python/最新转载/pandas使用的25个技巧.md" target="_blank" rel="noopener noreferrer">你要教我做事咯？</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">8/23/2020, 11:04:45 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/VuePress-blog/Python/最新转载/main函数的语法模板.html" class="prev">
        main函数的语法模板
      </a></span> <span class="next"><a href="/VuePress-blog/Python/最新转载/pyenv 和 pyenv-virtualenv 的安装、配置和使用.html">
        pyenv 和 pyenv-virtualenv 的安装、配置和使用
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/VuePress-blog/assets/js/app.776d277d.js" defer></script><script src="/VuePress-blog/assets/js/2.c5117f2a.js" defer></script><script src="/VuePress-blog/assets/js/22.207eb093.js" defer></script>
  </body>
</html>
